{"version":3,"file":"chat.cjs.development.js","sources":["../src/types/index.ts","../src/components/Emoji.tsx","../src/components/Typing.tsx","../node_modules/regenerator-runtime/runtime.js","../src/components/Entry.tsx","../src/utils/common.ts","../src/components/MessageContent/File.tsx","../src/components/MessageContent/Video.tsx","../src/components/MessageContent/Image.tsx","../src/components/MessageContent/index.tsx","../src/components/Message.tsx","../src/components/ContactStatus.tsx","../src/components/ContactList.tsx","../src/components/AddContact.tsx","../src/components/RoomHeader.tsx","../src/components/Room.tsx","../src/components/RoomListItem.tsx","../src/components/RoomList.tsx","../src/components/Conference.tsx","../src/components/ConferenceCall.tsx","../src/context/ChatContext.tsx","../src/context/RestContext.tsx","../src/hooks/useSocket.ts","../src/context/SocketContext.tsx","../src/pages/chat.tsx","../src/translations/index.ts"],"sourcesContent":["export interface ChatPa {\r\n  inModale?: boolean;\r\n  onlyChatGroupId?: number;\r\n}\r\n\r\n// Тип сообщения\r\nexport type MessageType =\r\n  | \"text\"\r\n  | \"image\"\r\n  | \"file\"\r\n  | \"video\"\r\n  | \"notify\"\r\n  | \"video_conference\";\r\n\r\nexport enum MessageStatus {\r\n  sent = 0,\r\n  read = 1\r\n}\r\n\r\nexport enum Role {\r\n  Unknown = 0,\r\n  Client = 1,\r\n  Agent = 2,\r\n  Specialist = 3,\r\n  Operator = 4\r\n}\r\n\r\nexport interface User {\r\n  userId: number;\r\n  username: string;\r\n  password: string;\r\n  avatar: string;\r\n  role?: Role;\r\n  online?: 1 | 0; // В сети\r\n  langCode?: string;\r\n}\r\n\r\n// Приватные сообщения\r\nexport interface PrivateMessage {\r\n  _id?: number;\r\n  userId: number;\r\n  contactId: number;\r\n  content: string;\r\n  messageType: MessageType;\r\n  status: MessageStatus;\r\n  cdate: string;\r\n  type?: string;\r\n  isRevoke?: boolean;\r\n  revokeUserName?: string;\r\n}\r\n\r\n// Контакт\r\nexport interface Contact {\r\n  userId: number;\r\n  groupId?: number;\r\n  username: string;\r\n  avatar?: string;\r\n  role?: Role;\r\n  messages?: PrivateMessage[];\r\n  unreadCount?: number;\r\n  isTop?: boolean;\r\n  online?: 1 | 0;\r\n  isManager?: 1 | 0;\r\n  noMoreData?: boolean;\r\n}\r\n\r\n// Информация о друзьях\r\nexport interface ContactGather {\r\n  [userId: number]: Contact;\r\n}\r\n\r\n// Групповое сообщение\r\nexport interface GroupMessage {\r\n  _id?: number;\r\n  userId: number;\r\n  groupId: number;\r\n  content: string;\r\n  messageType: MessageType;\r\n  cdate: string;\r\n  isRevoke?: boolean;\r\n  revokeUserName?: string;\r\n}\r\n\r\n// Группа\r\nexport interface Group {\r\n  groupId: number;\r\n  userId: number; // владелец\r\n  name: string;\r\n  notice: string;\r\n  messages?: GroupMessage[];\r\n  unreadCount?: number;\r\n  cdate: string;\r\n  isTop?: boolean;\r\n  members?: Contact[];\r\n  noMoreData?: boolean;\r\n}\r\n\r\n// Группы\r\nexport interface GroupGather {\r\n  [groupId: number]: Group;\r\n}\r\n\r\n// Ассоциации групп и пользователей\r\nexport interface GroupMap {\r\n  groupId: number;\r\n  userId: number;\r\n}\r\n\r\n// Ассоциации пользователей и друзей\r\nexport interface ContactMap {\r\n  contactId: number;\r\n  userId: number;\r\n}\r\n\r\nexport interface SendMessage {\r\n  message: string | File;\r\n  width?: number;\r\n  height?: number;\r\n  fileName?: string;\r\n  messageType: MessageType[0] | MessageType[1];\r\n  size?: number;\r\n}\r\n\r\n// Размер изображения\r\nexport interface ImageSize {\r\n  width: number;\r\n  height: number;\r\n}\r\n\r\n// Непрочитанные сообщения\r\nexport interface UnReadGather {\r\n  [key: string]: number;\r\n}\r\n\r\n// Получить сообщения постранично\r\nexport interface PagingParams {\r\n  groupId?: number;\r\n  userId?: number;\r\n  contactId?: number;\r\n  current: number;\r\n  pageSize: number;\r\n}\r\n\r\n// Постраничный ответ для групповых сообщений\r\nexport interface PagingResponse {\r\n  messageArr: GroupMessage[];\r\n  userArr: User[];\r\n}\r\n\r\nexport interface ContactUserMap {\r\n  contactId: number;\r\n  contactUserName: string;\r\n}\r\n\r\n// информация о том, что контакт печатает текст\r\nexport interface SetTyping {\r\n  userId?: number;\r\n  groupId?: number;\r\n  contactId?: number;\r\n}\r\n\r\n// Операция с сообщением\r\nexport interface MessageOperation {\r\n  userId?: number;\r\n  username: string;\r\n  groupId?: number;\r\n  contactId?: number;\r\n  _id: number;\r\n}\r\n\r\n// Данные конференции\r\nexport interface ConferenceData {\r\n  userId: number;\r\n  contactId: number;\r\n  id: string;\r\n  url?: string;\r\n  serverAddress?: string;\r\n  user?: string;\r\n  password?: string;\r\n}\r\n\r\n// Данные чата\r\nexport interface ChatData {\r\n  user: User;\r\n  groupData: Group[];\r\n  contactData: Contact[];\r\n  userData: User[];\r\n  operatorData: Contact[];\r\n  conferenceData: ConferenceData;\r\n}\r\n\r\nexport interface GroupMember {\r\n  groupId: number;\r\n  members: Contact[];\r\n}\r\n\r\nexport interface AddPrivateMessages {\r\n  pageSize: number;\r\n  contactId: number;\r\n  messages: PrivateMessage[];\r\n}\r\n\r\nexport interface AddGroupMessages extends PagingResponse {\r\n  pageSize: number;\r\n  groupId: number;\r\n}\r\n\r\nexport interface SetActiveRoom {\r\n  groupId?: number;\r\n  contactId?: number;\r\n  ifNotExists: boolean;\r\n}\r\n\r\nexport interface JoinGroup {\r\n  group: Group;\r\n  user: Contact;\r\n}\r\n\r\nexport interface SetUser {\r\n  user: User;\r\n  token: string;\r\n}\r\n\r\nexport type ChatRoom = Group | Contact;\r\nexport type ChatMessage = GroupMessage | PrivateMessage;\r\n\r\n// Операции контекстного меню\r\nexport enum ContextMenuType {\r\n  COPY = \"COPY\", // Скопировать\r\n  REVOKE = \"REVOKE\", // Удалить сообщение\r\n  TOP_REVERT = \"TOP_REVERT\", // Открепить\r\n  TOP = \"TOP\", // Закрепить\r\n  READ = \"READ\", // Прочесть всё\r\n  DELETE = \"DELETE\" // Удалить\r\n}\r\n","import * as React from \"react\";\r\nimport { Box,  } from \"@mui/material\";\r\nimport { makeStyles,createStyles } from '@mui/styles';\r\n\r\nconst useStyles = makeStyles(() =>\r\n  createStyles({\r\n    item: {\r\n      cursor: \"pointer\",\r\n    },\r\n  })\r\n);\r\n\r\ntype EmojiProps = {\r\n  onSelect?: (emoji: string) => void;\r\n};\r\n\r\ntype EmojiItemProps = {\r\n  emoji: string;\r\n};\r\n\r\nconst Emoji: React.FC<EmojiProps> = (props: EmojiProps) => {\r\n  const classes = useStyles();\r\n  const emojiClick = (e: React.MouseEvent<HTMLDivElement>) => {\r\n    if (props.onSelect) {\r\n      props.onSelect((e.target as HTMLDivElement).innerText);\r\n    }\r\n  };\r\n\r\n  const Item = (itemProps: EmojiItemProps) => {\r\n    return (\r\n      <Box\r\n        m={0.5}\r\n        component=\"span\"\r\n        onClick={emojiClick}\r\n        className={classes.item}\r\n      >\r\n        {itemProps.emoji}\r\n      </Box>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Box>\r\n      <Box display=\"flex\" flexDirection=\"row\">\r\n        <Item emoji=\"😃\" />\r\n        <Item emoji=\"😁\" />\r\n        <Item emoji=\"😂\" />\r\n        <Item emoji=\"😄\" />\r\n        <Item emoji=\"😅\" />\r\n        <Item emoji=\"😆\" />\r\n        <Item emoji=\"😇\" />\r\n        <Item emoji=\"😈\" />\r\n        <Item emoji=\"😉\" />\r\n      </Box>\r\n      <Box display=\"flex\" flexDirection=\"row\">\r\n        <Item emoji=\"😊\" />\r\n        <Item emoji=\"😋\" />\r\n        <Item emoji=\"😌\" />\r\n        <Item emoji=\"😍\" />\r\n        <Item emoji=\"😎\" />\r\n        <Item emoji=\"😏\" />\r\n        <Item emoji=\"😐\" />\r\n        <Item emoji=\"😒\" />\r\n        <Item emoji=\"😓\" />\r\n      </Box>\r\n      <Box display=\"flex\" flexDirection=\"row\">\r\n        <Item emoji=\"❓\" />\r\n        <Item emoji=\"😕\" />\r\n        <Item emoji=\"😖\" />\r\n        <Item emoji=\"😗\" />\r\n        <Item emoji=\"😘\" />\r\n        <Item emoji=\"😙\" />\r\n        <Item emoji=\"😚\" />\r\n        <Item emoji=\"😜\" />\r\n        <Item emoji=\"😝\" />\r\n      </Box>\r\n      <Box display=\"flex\" flexDirection=\"row\">\r\n        <Item emoji=\"😞\" />\r\n        <Item emoji=\"😟\" />\r\n        <Item emoji=\"😠\" />\r\n        <Item emoji=\"😡\" />\r\n        <Item emoji=\"😢\" />\r\n        <Item emoji=\"😣\" />\r\n        <Item emoji=\"😤\" />\r\n        <Item emoji=\"😥\" />\r\n        <Item emoji=\"😦\" />\r\n      </Box>\r\n      <Box display=\"flex\" flexDirection=\"row\">\r\n        <Item emoji=\"😨\" />\r\n        <Item emoji=\"😩\" />\r\n        <Item emoji=\"😪\" />\r\n        <Item emoji=\"😫\" />\r\n        <Item emoji=\"😬\" />\r\n        <Item emoji=\"😭\" />\r\n        <Item emoji=\"😮\" />\r\n        <Item emoji=\"😯\" />\r\n        <Item emoji=\"😰\" />\r\n      </Box>\r\n      <Box display=\"flex\" flexDirection=\"row\">\r\n        <Item emoji=\"😲\" />\r\n        <Item emoji=\"😳\" />\r\n        <Item emoji=\"😴\" />\r\n        <Item emoji=\"😵\" />\r\n        <Item emoji=\"🧐\" />\r\n        <Item emoji=\"😷\" />\r\n        <Item emoji=\"🙁\" />\r\n        <Item emoji=\"🙂\" />\r\n        <Item emoji=\"🙃\" />\r\n      </Box>\r\n      <Box display=\"flex\" flexDirection=\"row\">\r\n        <Item emoji=\"🤐\" />\r\n        <Item emoji=\"🤑\" />\r\n        <Item emoji=\"🤒\" />\r\n        <Item emoji=\"🤓\" />\r\n        <Item emoji=\"🤔\" />\r\n        <Item emoji=\"🤕\" />\r\n        <Item emoji=\"🤠\" />\r\n        <Item emoji=\"🤡\" />\r\n        <Item emoji=\"🤢\" />\r\n      </Box>\r\n      <Box display=\"flex\" flexDirection=\"row\">\r\n        <Item emoji=\"🤤\" />\r\n        <Item emoji=\"🤥\" />\r\n        <Item emoji=\"🤧\" />\r\n        <Item emoji=\"🤨\" />\r\n        <Item emoji=\"🤩\" />\r\n        <Item emoji=\"🤪\" />\r\n        <Item emoji=\"🤫\" />\r\n        <Item emoji=\"🤬\" />\r\n        <Item emoji=\"🤭\" />\r\n      </Box>\r\n    </Box>\r\n  );\r\n};\r\nexport default Emoji;\r\n","import React from \"react\";\r\nimport { Typography } from \"@mui/material\";\r\nimport { Theme } from '@mui/material/styles';\r\nimport { makeStyles, createStyles } from '@mui/styles';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    typingText: {\r\n      paddingLeft: theme.spacing(0.5),\r\n    },\r\n    typingDot: {\r\n      display: \"inline-block\",\r\n      verticalAlign: \"middle\",\r\n      width: 4,\r\n      height: 4,\r\n      margin: \"0px 2px\",\r\n      background: theme.palette.primary.main,\r\n      borderRadius: \"50%\",\r\n      opacity: \"0\",\r\n      animation: \"$loadingFade 1s infinite\",\r\n      \"&:nth-child(1)\": {\r\n        animationDelay: \"0s\",\r\n      },\r\n      \"&:nth-child(2)\": {\r\n        animationDelay: \"0.2s\",\r\n      },\r\n      \"&:nth-child(3)\": {\r\n        animationDelay: \"0.4s\",\r\n      },\r\n    },\r\n    \"@keyframes loadingFade\": {\r\n      \"0%\": {\r\n        opacity: 0,\r\n      },\r\n      \"50%\": {\r\n        opacity: 0.8,\r\n      },\r\n      \"100%\": {\r\n        opacity: 0,\r\n      },\r\n    },\r\n  })\r\n);\r\n\r\ntype TypingProps = {\r\n  message: string;\r\n};\r\n\r\nconst Typing: React.FC<TypingProps> = (props: TypingProps) => {\r\n  const classes = useStyles();\r\n  return (\r\n    <Typography color=\"primary\" variant=\"body2\" component=\"span\">\r\n      <span className={classes.typingDot} />\r\n      <span className={classes.typingDot} />\r\n      <span className={classes.typingDot} />\r\n      <span className={classes.typingText}>{props.message}</span>\r\n    </Typography>\r\n  );\r\n};\r\nexport default Typing;\r\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = GeneratorFunctionPrototype;\n  define(Gp, \"constructor\", GeneratorFunctionPrototype);\n  define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction);\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  });\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  define(Gp, iteratorSymbol, function() {\n    return this;\n  });\n\n  define(Gp, \"toString\", function() {\n    return \"[object Generator]\";\n  });\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, in modern engines\n  // we can explicitly access globalThis. In older engines we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","import React, { ChangeEvent, KeyboardEvent } from \"react\";\r\nimport {\r\n  Box,\r\n  IconButton,\r\n  InputAdornment,\r\n  TextField,\r\n  Popover,\r\n  SvgIcon,\r\n} from \"@mui/material\";\r\n\r\nimport { makeStyles } from '@mui/styles';\r\nimport { Send, InsertEmoticon } from \"@mui/icons-material\";\r\nimport Emoji from \"./Emoji\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { ChatRoom, ImageSize, SendMessage } from \"../types\";\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  input: {\r\n    flex: \"auto\",\r\n  },\r\n  inputUpload: {\r\n    display: \"none\",\r\n  },\r\n  attachmentIcon: {\r\n    fill: \"none\",\r\n    stroke: \"currentColor\",\r\n  },\r\n}));\r\n\r\ntype EntryProps = {\r\n  chat: ChatRoom | null;\r\n  onTyping?: (chat: ChatRoom) => void;\r\n  onSendMessage?: (chat: ChatRoom, data: SendMessage) => void;\r\n};\r\n\r\n/**\r\n * Рассчитать пропорции изображения\r\n */\r\nconst getImageSize = (data: ImageSize) => {\r\n  let { width, height } = data;\r\n  if (width > 335 || height > 335) {\r\n    if (width > height) {\r\n      height = 335 * (height / width);\r\n      width = 335;\r\n    } else {\r\n      width = 335 * (width / height);\r\n      height = 335;\r\n    }\r\n  }\r\n  return {\r\n    width,\r\n    height,\r\n  };\r\n};\r\n\r\nconst Entry: React.FC<EntryProps> = (props: EntryProps) => {\r\n  const classes = useStyles();\r\n  const { chat } = props;\r\n\r\n  const { t } = useTranslation();\r\n\r\n  const [empjiEl, setEmojiEl] = React.useState<HTMLButtonElement | null>(null);\r\n  const [text, setText] = React.useState(\"\");\r\n  const [lastTyping, setLastTyping] = React.useState({\r\n    chat,\r\n    time: 0,\r\n  });\r\n\r\n  const handleEmojiClick = (event: React.MouseEvent<HTMLButtonElement>) => {\r\n    setEmojiEl(event.currentTarget);\r\n  };\r\n\r\n  const handleEmojiClose = () => {\r\n    setEmojiEl(null);\r\n  };\r\n\r\n  const emojiSelect = (emoji: string) => {\r\n    setText(`${text}${emoji}`);\r\n    handleEmojiClose();\r\n  };\r\n\r\n  const onChange = ({ target }: ChangeEvent<HTMLInputElement>) => {\r\n    setText(target.value);\r\n    if (\r\n      chat &&\r\n      props.onTyping &&\r\n      (lastTyping.chat !== chat || Date.now() - lastTyping.time >= 500)\r\n    ) {\r\n      setLastTyping({\r\n        chat,\r\n        time: Date.now(),\r\n      });\r\n      props.onTyping(chat);\r\n    }\r\n  };\r\n\r\n  const sendMessage = (data: SendMessage) => {\r\n    if (chat && props.onSendMessage) props.onSendMessage(chat, data);\r\n  };\r\n\r\n  const submit = () => {\r\n    if (text.trim().length === 0) {\r\n      return;\r\n    }\r\n\r\n    sendMessage({ message: text, messageType: \"text\" });\r\n    setText(\"\");\r\n  };\r\n\r\n  const onSubmitClick = (event: React.MouseEvent<HTMLButtonElement>) => {\r\n    event.preventDefault();\r\n    submit();\r\n  };\r\n\r\n  const onKeyPress = (event: KeyboardEvent<HTMLInputElement>) => {\r\n    if (event.key === \"Enter\") {\r\n      event.preventDefault();\r\n      submit();\r\n    }\r\n  };\r\n\r\n  const onSubmitFile = (event: React.FormEvent<HTMLInputElement>) => {\r\n    if (!event.currentTarget.files) return;\r\n    const file = event.currentTarget.files[0];\r\n    let messageType: string;\r\n    if (file.type.includes(\"image\")) {\r\n      messageType = \"image\";\r\n    } else if (file.type.includes(\"video\")) {\r\n      messageType = \"video\";\r\n    } else {\r\n      messageType = \"file\";\r\n    }\r\n    if (messageType === \"image\") {\r\n      const image = new Image();\r\n      const url = window.URL || window.webkitURL;\r\n      image.src = url.createObjectURL(file);\r\n      image.onload = () => {\r\n        const imageSize: ImageSize = getImageSize({\r\n          width: image.width,\r\n          height: image.height,\r\n        });\r\n        sendMessage({\r\n          message: file,\r\n          width: imageSize.width,\r\n          height: imageSize.height,\r\n          messageType,\r\n        });\r\n      };\r\n    } else {\r\n      sendMessage({\r\n        message: file,\r\n        messageType,\r\n        fileName: file.name,\r\n        size: file.size,\r\n      });\r\n    }\r\n  };\r\n\r\n  const emojiOpen = Boolean(empjiEl);\r\n  const enojiId = emojiOpen ? \"simple-popover\" : undefined;\r\n  return (\r\n    <Box display=\"flex\" flexDirection=\"row\">\r\n      <TextField\r\n        className={classes.input}\r\n        placeholder={t(\"CHAT.INPUT_MESSAGE\")}\r\n        autoFocus={true}\r\n        variant=\"standard\"\r\n        InputProps={{\r\n          disableUnderline: true,\r\n          startAdornment: (\r\n            <InputAdornment position={\"start\"}>\r\n              <input\r\n                accept=\"*\"\r\n                className={classes.inputUpload}\r\n                id=\"icon-button-file\"\r\n                type=\"file\"\r\n                onChange={onSubmitFile}\r\n              />\r\n              <label htmlFor=\"icon-button-file\">\r\n                <IconButton\r\n                  color=\"primary\"\r\n                  aria-label=\"upload\"\r\n                  component=\"span\"\r\n                  size=\"small\"\r\n                >\r\n                  <SvgIcon fill=\"none\" className={classes.attachmentIcon}>\r\n                    <path\r\n                      d=\"M16.768 13.5767L11.6961 18.6486C9.35886 20.9859 5.56937 20.9859 3.23208 18.6486V18.6486C0.894789 16.3114 0.894789 12.5219 3.23208 10.1846L10.4479 2.96872C12.0875 1.32914 14.7458 1.32914 16.3854 2.96873V2.96873C18.025 4.60831 18.025 7.26659 16.3854 8.90617L9.16515 16.1264C8.23032 17.0612 6.71466 17.0612 5.77982 16.1264V16.1264C4.84499 15.1916 4.84499 13.6759 5.77982 12.7411L10.8896 7.63131\"\r\n                      strokeWidth=\"1.6\"\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                    />\r\n                  </SvgIcon>\r\n                </IconButton>\r\n              </label>{\" \"}\r\n              <IconButton\r\n                aria-describedby={enojiId}\r\n                onClick={handleEmojiClick}\r\n                color=\"primary\"\r\n                size=\"small\"\r\n              >\r\n                <InsertEmoticon />\r\n              </IconButton>\r\n            </InputAdornment>\r\n          ),\r\n          endAdornment: (\r\n            <IconButton\r\n              edge=\"end\"\r\n              color=\"inherit\"\r\n              size=\"small\"\r\n              onClick={onSubmitClick}\r\n            >\r\n              <Send />\r\n            </IconButton>\r\n          ),\r\n        }}\r\n        value={text}\r\n        onChange={onChange}\r\n        onKeyPress={onKeyPress}\r\n      />\r\n      <Popover\r\n        id={enojiId}\r\n        open={emojiOpen}\r\n        anchorEl={empjiEl}\r\n        onClose={handleEmojiClose}\r\n        anchorOrigin={{\r\n          vertical: \"top\",\r\n          horizontal: \"center\",\r\n        }}\r\n        transformOrigin={{\r\n          vertical: \"bottom\",\r\n          horizontal: \"left\",\r\n        }}\r\n      >\r\n        <Emoji onSelect={emojiSelect} />\r\n      </Popover>\r\n    </Box>\r\n  );\r\n};\r\nexport default Entry;\r\n","import moment from \"moment\";\r\nimport { ChatRoom, Contact, Group } from \"../types\";\r\n\r\nexport function isEmpty(value: unknown): boolean {\r\n  return (\r\n    value == null ||\r\n    (typeof value === \"object\" && Object.keys(value).length === 0) ||\r\n    (typeof value === \"string\" && value.trim().length === 0)\r\n  );\r\n}\r\n\r\n// string contains string\r\nexport function isContainStr(str1: string, str2: string): boolean {\r\n  return str2.indexOf(str1) >= 0;\r\n}\r\n\r\n/**\r\n * check URL\r\n * @param text\r\n */\r\nexport function isUrl(text: string): boolean {\r\n  // parse url\r\n  const UrlReg = new RegExp(/http(s)?:\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- ./?%&=]*)?/);\r\n  return UrlReg.test(text);\r\n}\r\n\r\n/**\r\n * Формитирование времени сообщения\r\n * @param time\r\n */\r\nexport function formatTime(time: Date | string | undefined) {\r\n  if (typeof time === \"undefined\") return null;\r\n  if (typeof time === \"string\") time = new Date(time);\r\n  // больше чем вчера\r\n  if (\r\n    moment()\r\n      .add(-1, \"days\")\r\n      .startOf(\"day\")\r\n      .isAfter(time)\r\n  ) {\r\n    return moment(time).format(\"DD.MM.YYYY HH:mm\");\r\n  }\r\n  // вчера\r\n  if (\r\n    moment()\r\n      .startOf(\"day\")\r\n      .isAfter(time)\r\n  ) {\r\n    return `Вчера в ${moment(time).format(\"HH:mm\")}`;\r\n  }\r\n\r\n  return moment(time).format(\"HH:mm\");\r\n}\r\n\r\n/**\r\n * Раскрыть содержимое\r\n * @param content - данные в строке\r\n */\r\nexport function getFileMeta(\r\n  content: string\r\n): {\r\n  date: string;\r\n  userId: string;\r\n  size: string;\r\n  name: string;\r\n} {\r\n  // Формат  [date]$[userId]$[size]$[fileName]\r\n  // Например fileName = 1606980397047$1a01e20f-3780-4227-84b5-5c69ca766ee5$15.41KB$123.docx\r\n  const meta = content.split(\"$\");\r\n  const [date, userId, size, name] = meta;\r\n  return {\r\n    date,\r\n    userId,\r\n    size,\r\n    name\r\n  };\r\n}\r\n\r\nexport function getImageMeta(\r\n  content: string\r\n): {\r\n  date: string;\r\n  userId: string;\r\n  width: string;\r\n  height: string;\r\n} {\r\n  // Формат [date]$[userId]$[width]$[height]$...\r\n  const meta = content.split(\"$\");\r\n  const [date, userId, width, height] = meta;\r\n  return {\r\n    date,\r\n    userId,\r\n    width,\r\n    height\r\n  };\r\n}\r\n\r\nexport function splitFileName(name: string): { name: string; ext: string } {\r\n  const idx = name.lastIndexOf(\".\");\r\n  if (idx === -1)\r\n    return {\r\n      name,\r\n      ext: \"\"\r\n    };\r\n  return {\r\n    name: name.slice(0, idx),\r\n    ext: name.slice(idx + 1)\r\n  };\r\n}\r\n\r\nexport const getChatId = (chat: ChatRoom | null): string | null => {\r\n  if (!chat) return null;\r\n  return (chat as Group).groupId\r\n    ? `group:${(chat as Group).groupId}`\r\n    : `user:${chat.userId}`;\r\n};\r\n\r\nexport const getChatName = (chat: ChatRoom): string => {\r\n  return (chat as Group).groupId\r\n    ? (chat as Group).name\r\n    : (chat as Contact).username;\r\n};\r\n\r\nexport const chatRoomComparer = (a: ChatRoom, b: ChatRoom): number => {\r\n  const hasMessagesA = Array.isArray(a.messages) && a.messages.length > 0;\r\n  const hasMessagesB = Array.isArray(b.messages) && b.messages.length > 0;\r\n  if (\r\n    hasMessagesA &&\r\n    hasMessagesB &&\r\n    b.messages != null &&\r\n    a.messages != null\r\n  ) {\r\n    return (\r\n      new Date(b.messages[b.messages.length - 1].cdate).getTime() -\r\n      new Date(a.messages[a.messages.length - 1].cdate).getTime()\r\n    );\r\n  }\r\n  if (hasMessagesA) {\r\n    return -1;\r\n  }\r\n  return 1;\r\n};\r\n","import React from \"react\";\r\nimport {\r\n  Avatar,\r\n  Box,\r\n} from \"@mui/material\";\r\nimport { Theme } from '@mui/material/styles';\r\nimport { makeStyles, createStyles } from '@mui/styles';\r\nimport { getFileMeta, splitFileName } from \"../../utils/common\";\r\nimport { ChatMessage } from \"../../types\";\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    fileIcon: {\r\n      fontSize: \"0.75rem\",\r\n    },\r\n    fileBody: {\r\n      paddingLeft: theme.spacing(1),\r\n    },\r\n  })\r\n);\r\ntype FileProps = {\r\n  message: ChatMessage;\r\n};\r\n\r\nconst File: React.FC<FileProps> = ({ message }: FileProps) => {\r\n  const classes = useStyles();\r\n  const meta = getFileMeta(message.content);\r\n  const { name, ext } = splitFileName(meta.name);\r\n  return (\r\n    <Box display=\"flex\" flexDirection=\"row\">\r\n      <Avatar className={classes.fileIcon}>{ext.toUpperCase()}</Avatar>\r\n      <Box display=\"flex\" flexDirection=\"column\" className={classes.fileBody}>\r\n        {name}\r\n        <span>{`${ext} ${meta.size}`}</span>\r\n      </Box>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default File;\r\n","import React from \"react\";\r\nimport { makeStyles } from '@mui/styles';\r\nimport { ChatMessage } from \"../../types\";\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  mediaContent: {\r\n    maxWidth: 350,\r\n    maxHeight: 350,\r\n  },\r\n}));\r\n\r\ntype VideoProps = {\r\n  apiUrl: string;\r\n  message: ChatMessage;\r\n  isConference: boolean;\r\n};\r\n\r\nconst Video: React.FC<VideoProps> = ({\r\n  apiUrl,\r\n  message,\r\n  isConference,\r\n}: VideoProps) => {\r\n  const classes = useStyles();\r\n  let src = \"\";\r\n  if (isConference) {\r\n    const meta = JSON.parse(message.content);\r\n    src = `${apiUrl}/static/conf/${meta.visitId}/${meta.name}`;\r\n  } else src = `${apiUrl}/static/file/${message.content}`;\r\n  return (\r\n    <video src={src} className={classes.mediaContent} controls muted>\r\n      Ваш браузер не поддерживает тег video.\r\n    </video>\r\n  );\r\n};\r\n\r\nexport default Video;\r\n","import React from \"react\";\r\nimport Viewer from \"react-viewer\";\r\nimport { Theme } from '@mui/material/styles';\r\nimport { getImageMeta } from \"../../utils/common\";\r\nimport { ChatMessage } from \"../../types\";\r\nimport { makeStyles, createStyles } from '@mui/styles';\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    mediaContent: {\r\n      maxWidth: 350,\r\n      maxHeight: 350,\r\n      cursor: \"pointer\",\r\n      [theme.breakpoints.down(\"sm\")]: {\r\n        maxWidth: 250,\r\n        maxHeight: 250,\r\n      },\r\n    },\r\n  })\r\n);\r\ntype ImageProrps = {\r\n  apiUrl: string;\r\n  message: ChatMessage;\r\n};\r\n\r\nconst Image: React.FC<ImageProrps> = ({ apiUrl, message }: ImageProrps) => {\r\n  const classes = useStyles();\r\n  const [viewerVisible, setViewerVisible] = React.useState(false);\r\n  const meta = getImageMeta(message.content);\r\n  return (\r\n    <React.Fragment>\r\n      <Viewer\r\n        zIndex={2000}\r\n        visible={viewerVisible}\r\n        changeable={false}\r\n        onClose={() => {\r\n          setViewerVisible(false);\r\n        }}\r\n        images={[\r\n          {\r\n            src: `${apiUrl}/static/image/${message.content}`,\r\n          },\r\n        ]}\r\n      />\r\n      <img\r\n        src={`${apiUrl}/static/image/${message.content}`}\r\n        width={meta.width}\r\n        height={meta.height}\r\n        className={classes.mediaContent}\r\n        onClick={() => {\r\n          setViewerVisible(true);\r\n        }}\r\n      />\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nexport default Image;\r\n","import React from \"react\";\r\nimport File from \"./File\";\r\nimport Video from \"./Video\";\r\nimport Image from \"./Image\";\r\nimport { ChatMessage } from \"../../types\";\r\n\r\ntype MessageProps = {\r\n  apiUrl: string;\r\n  message: ChatMessage;\r\n};\r\nconst MessageContent: React.FC<MessageProps> = ({\r\n  apiUrl,\r\n  message,\r\n}: MessageProps) => {\r\n  switch (message.messageType) {\r\n    case \"text\":\r\n      return <React.Fragment>{message.content}</React.Fragment>;\r\n    case \"video\":\r\n    case \"video_conference\":\r\n      return (\r\n        <Video\r\n          message={message}\r\n          apiUrl={apiUrl}\r\n          isConference={message.messageType === \"video_conference\"}\r\n        />\r\n      );\r\n    case \"image\":\r\n      return <Image message={message} apiUrl={apiUrl} />;\r\n    case \"file\":\r\n      return <File message={message} />;\r\n  }\r\n  return null;\r\n};\r\n\r\nexport default MessageContent;\r\n","import * as React from \"react\";\r\nimport {\r\n  Box,\r\n  Link,\r\n  ListItem,\r\n  Typography,\r\n} from \"@mui/material\";\r\nimport { Theme } from '@mui/material/styles';\r\nimport { makeStyles, createStyles } from '@mui/styles';\r\nimport { DoneAll, Done } from \"@mui/icons-material\";\r\nimport { formatTime } from \"../utils/common\";\r\nimport MessageContent from \"./MessageContent\";\r\nimport { Alert } from \"@mui/lab\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { ChatMessage, Contact, PrivateMessage, User } from \"../types\";\r\n\r\ntype MessageProps = {\r\n  apiUrl: string;\r\n  user: User;\r\n  message: ChatMessage;\r\n  owner: Contact;\r\n  isGroupMessage: boolean; // сообщение в группу\r\n  isUserFirst: boolean; // начинает группу сообщений от одного пользователя\r\n  isUserLast: boolean; // завершает группу сообщений от одного пользователя\r\n  refOnLastMess: React.RefObject<HTMLDivElement> | null;\r\n  onContextMenu: (event: React.MouseEvent<HTMLElement>) => void;\r\n};\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    rootContact: {\r\n      \"& span\": {\r\n        float: \"right\",\r\n        color: \"#B2B6C2\",\r\n      },\r\n      \"& $message\": {\r\n        backgroundColor: \"#F1F4FC\",\r\n        color: \"black\",\r\n      },\r\n      \"& $lastMessage\": {\r\n        borderBottomLeftRadius: 0,\r\n      },\r\n    },\r\n    rootUser: {\r\n      justifyContent: \"flex-end\",\r\n      \"& span\": {\r\n        float: \"right\",\r\n        color: \"#D9DEEC\",\r\n      },\r\n      \"& $message\": {\r\n        backgroundColor: theme.palette.primary.main,\r\n        color: theme.palette.primary.contrastText,\r\n      },\r\n      \"& $lastMessage\": {\r\n        borderBottomRightRadius: 0,\r\n      },\r\n    },\r\n    rootNotify: {\r\n      justifyContent: \"center\",\r\n      \"& > *\": {\r\n        padding: `0px ${theme.spacing(1)}`,\r\n        borderRadius: 16,\r\n        fontWeight: 500,\r\n      },\r\n    },\r\n    message: {\r\n      maxWidth: \"85%\",\r\n      borderRadius: 16,\r\n      padding: theme.spacing(1),\r\n    },\r\n    lastMessage: {},\r\n    file: {\r\n      display: \"flex\",\r\n      flexDirection: \"row\",\r\n      flexWrap: \"wrap\",\r\n      cursor: \"pointer\",\r\n    },\r\n    header: {\r\n      flex: \"0 0 100%\",\r\n      overflow: \"hidden\",\r\n      fontWeight: \"bold\",\r\n    },\r\n    body: {\r\n      flex: \"1 1 auto\",\r\n      wordBreak: \"break-word\",\r\n      overflow: \"hidden\",\r\n    },\r\n    status: {\r\n      paddingLeft: theme.spacing(1),\r\n      flex: \"1 1 auto\",\r\n      alignSelf: \"flex-end\",\r\n    },\r\n    statusImage: {\r\n      fontSize: \"1rem\",\r\n      marginRight: theme.spacing(0.5),\r\n      verticalAlign: \"middle\",\r\n    },\r\n  })\r\n);\r\n\r\nconst wrapMessage = (\r\n  apiUrl: string,\r\n  message: ChatMessage,\r\n  classes: ReturnType<typeof useStyles>,\r\n  isUserLast: boolean,\r\n  onContextMenu: ((event: React.MouseEvent<HTMLElement>) => void) | undefined,\r\n  child: JSX.Element\r\n) => {\r\n  const { messageType } = message;\r\n\r\n  const className = isUserLast\r\n    ? `${classes.message} ${classes.lastMessage}`\r\n    : classes.message;\r\n\r\n  if (messageType === \"file\") {\r\n    return (\r\n      <Link\r\n        className={`${className} ${classes.file}`}\r\n        underline=\"none\"\r\n        href={`${apiUrl}/static/file/${message.content}`}\r\n        target=\"_blank\"\r\n        download\r\n        onContextMenu={onContextMenu}\r\n      >\r\n        {child}\r\n      </Link>\r\n    );\r\n  }\r\n  const isMedia =\r\n    messageType === \"image\" ||\r\n    messageType === \"video\" ||\r\n    messageType === \"video_conference\";\r\n  return (\r\n    <Box\r\n      display=\"flex\"\r\n      flexDirection={isMedia ? \"column\" : \"row\"}\r\n      flexWrap=\"wrap\"\r\n      className={className}\r\n      onContextMenu={onContextMenu}\r\n    >\r\n      {child}\r\n    </Box>\r\n  );\r\n};\r\n\r\nconst Message: React.FC<MessageProps> = (props: MessageProps) => {\r\n  const classes = useStyles();\r\n  const { t } = useTranslation();\r\n\r\n  const {\r\n    apiUrl,\r\n    message,\r\n    owner,\r\n    refOnLastMess,\r\n    user,\r\n    isGroupMessage,\r\n    isUserFirst,\r\n    isUserLast,\r\n  } = props;\r\n\r\n  if (message.messageType === \"notify\") {\r\n    // Уведомление - особый случай\r\n    const content =\r\n      message.content[0] === \"{\"\r\n        ? JSON.parse(message.content)\r\n        : message.content;\r\n    return (\r\n      <ListItem className={classes.rootNotify}>\r\n        <Alert\r\n          severity={typeof content === \"string\" ? \"info\" : content.severity}\r\n          ref={refOnLastMess}\r\n        >\r\n          {typeof content === \"string\" ? content : content.message}\r\n        </Alert>\r\n      </ListItem>\r\n    );\r\n  }\r\n\r\n  if (message.isRevoke) {\r\n    // Удаленное сообщение\r\n    return (\r\n      <ListItem className={classes.rootNotify}>\r\n        <Typography variant=\"body2\" ref={refOnLastMess} align=\"center\">\r\n          {message.userId === user.userId\r\n            ? t(\"CHAT.MESSAGE.REVOKED.YOU\")\r\n            : `${message.revokeUserName} ${t(\"CHAT.MESSAGE.REVOKED.CONTACT\")}`}\r\n        </Typography>\r\n      </ListItem>\r\n    );\r\n  }\r\n\r\n  const isMine = user.userId === message.userId;\r\n\r\n  return (\r\n    <ListItem className={isMine ? classes.rootUser : classes.rootContact}>\r\n      {wrapMessage(\r\n        apiUrl,\r\n        message,\r\n        classes,\r\n        isUserLast,\r\n        props.onContextMenu,\r\n        <React.Fragment>\r\n          {!isMine && isGroupMessage && owner && isUserFirst && (\r\n            <div className={classes.header}>{owner.username}</div>\r\n          )}\r\n          <div className={classes.body}>\r\n            <MessageContent message={message} apiUrl={apiUrl} />\r\n          </div>\r\n          <div className={classes.status} ref={refOnLastMess}>\r\n            <span>\r\n              {isMine ? (\r\n                (message as PrivateMessage).status === 0 ? (\r\n                  <Done className={classes.statusImage} />\r\n                ) : (\r\n                  <DoneAll className={classes.statusImage} />\r\n                )\r\n              ) : null}\r\n              {formatTime(message.cdate)}\r\n            </span>\r\n          </div>\r\n        </React.Fragment>\r\n      )}\r\n    </ListItem>\r\n  );\r\n};\r\nexport default Message;\r\n","import React from \"react\";\r\nimport { Typography } from \"@mui/material\";\r\nimport Typing from \"./Typing\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Contact } from \"../types\";\r\n\r\ntype ContactStatusProps = {\r\n  contact: Contact;\r\n  isTyping: boolean;\r\n};\r\n\r\nconst ContactStatus: React.FC<ContactStatusProps> = (\r\n  props: ContactStatusProps\r\n) => {\r\n  const { t } = useTranslation();\r\n\r\n  if (props.isTyping) return <Typing message={t(\"CHAT.STATUS.TYPING\")} />;\r\n  if (props.contact.online === 1)\r\n    return (\r\n      <Typography variant=\"body2\" color=\"primary\" component=\"span\">\r\n        {t(\"CHAT.STATUS.ONLINE\")}\r\n      </Typography>\r\n    );\r\n  return (\r\n    <Typography variant=\"body2\" color=\"textSecondary\" component=\"span\">\r\n      {t(\"CHAT.STATUS.OFFLINE\")}\r\n    </Typography>\r\n  );\r\n};\r\n\r\nexport default ContactStatus;\r\n","import React from \"react\";\r\nimport {\r\n  Avatar,\r\n  List,\r\n  ListItem,\r\n  ListItemAvatar,\r\n  ListItemText,\r\n} from \"@mui/material\";\r\nimport StarIcon from \"@mui/icons-material/Star\";\r\nimport ContactStatus from \"./ContactStatus\";\r\nimport { makeStyles } from '@mui/styles';\r\nimport { Contact } from \"../types\";\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  star: {\r\n    fontSize: \"0.85rem\",\r\n    verticalAlign: \"middle\",\r\n  },\r\n}));\r\n\r\ntype ContactListProps = {\r\n  apiUrl: string;\r\n  contacts: Contact[];\r\n  owner?: number;\r\n  onClick?: (contact: Contact) => void;\r\n};\r\n\r\nconst ContactList: React.FC<ContactListProps> = (props: ContactListProps) => {\r\n  const classes = useStyles();\r\n  const { apiUrl, contacts, owner } = props;\r\n\r\n  return (\r\n    <List aria-label=\"contacts\">\r\n      {contacts.map((contact) => (\r\n        <ListItem\r\n          button\r\n          key={contact.userId}\r\n          onClick={() => props.onClick && props.onClick(contact)}\r\n        >\r\n          <ListItemAvatar>\r\n            <Avatar alt={contact.username} src={`${apiUrl}${contact.avatar}`} />\r\n          </ListItemAvatar>\r\n          <ListItemText\r\n            primary={\r\n              <span>\r\n                {contact.username}{\" \"}\r\n                {owner === contact.userId && (\r\n                  <StarIcon className={classes.star} color=\"primary\" />\r\n                )}\r\n              </span>\r\n            }\r\n            secondary={<ContactStatus contact={contact} isTyping={false} />}\r\n          />\r\n        </ListItem>\r\n      ))}\r\n    </List>\r\n  );\r\n};\r\nexport default ContactList;\r\n","import { Dialog, DialogTitle } from \"@mui/material\";\r\nimport React from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Contact } from \"../types\";\r\nimport ContactList from \"./ContactList\";\r\n\r\ninterface AddContactProps {\r\n  open: boolean;\r\n  apiUrl: string;\r\n  contacts: Contact[];\r\n  onClose: (value?: Contact) => void;\r\n}\r\n\r\nconst AddContact: React.FC<AddContactProps> = (\r\n  props: AddContactProps\r\n) => {\r\n  const { onClose, open, apiUrl, contacts } = props;\r\n  const { t } = useTranslation();\r\n\r\n  const handleClose = () => {\r\n    onClose();\r\n  };\r\n\r\n  const handleListItemClick = (contact: Contact) => {\r\n    onClose(contact);\r\n  };\r\n\r\n  return (\r\n    <Dialog\r\n      onClose={handleClose}\r\n      aria-labelledby=\"add-contact-title\"\r\n      open={open}\r\n    >\r\n      <DialogTitle id=\"switch-operator-title\">\r\n        {t(\"CHAT.ADD_CONTACT\")}\r\n      </DialogTitle>\r\n      <ContactList\r\n        apiUrl={apiUrl}\r\n        contacts={contacts}\r\n        onClick={handleListItemClick}\r\n      />\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default AddContact;","import React from \"react\";\r\nimport {\r\n  Avatar,\r\n  CardHeader,\r\n  Button,\r\n  Popover,\r\n  IconButton,\r\n} from \"@mui/material\";\r\nimport { Theme } from '@mui/material/styles';\r\nimport GroupIcon from \"@mui/icons-material/Group\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport VideoCallIcon from \"@mui/icons-material/VideoCall\";\r\nimport CallEndIcon from \"@mui/icons-material/CallEnd\";\r\nimport PersonAddIcon from \"@mui/icons-material/PersonAdd\";\r\nimport DeleteIcon from \"@mui/icons-material/Delete\";\r\nimport ContactStatus from \"./ContactStatus\";\r\nimport ContactList from \"./ContactList\";\r\nimport AddContact from \"./AddContact\";\r\nimport {\r\n  ChatRoom,\r\n  Contact,\r\n  Group,\r\n  SetTyping,\r\n  User,\r\n  ConferenceData,\r\n} from \"../types\";\r\nimport { makeStyles, createStyles } from '@mui/styles';\r\nimport { isEmpty } from \"../utils/common\";\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    popover: {\r\n      pointerEvents: \"none\",\r\n    },\r\n    paper: {\r\n      padding: theme.spacing(1),\r\n    },\r\n    avatarGroup: {\r\n      backgroundColor: \"#28B7C6\",\r\n      color: \"#fff\",\r\n    },\r\n  })\r\n);\r\n\r\ntype RoomHeaderProps = {\r\n  apiUrl: string;\r\n  user: User;\r\n  chat: ChatRoom | null;\r\n  typing: SetTyping | null;\r\n  conference: ConferenceData | null;\r\n  className: string;\r\n  operators: Contact[];\r\n  onVideoCall?: (chat: ChatRoom) => void;\r\n  onVideoEnd?: (conference: ConferenceData) => void;\r\n  onConferencePause?: (conference: ConferenceData) => void;\r\n  onOperatorAdd?: (chat: Group, operator: Contact) => void;\r\n  onLeaveGroup?: (chat: Group) => void;\r\n};\r\n\r\nconst getGroupStatus = (group: Group, t: (key: string) => string) => {\r\n  const status = [`${group.members?.length} ${t(\"CHAT.MEMBERS\")}`];\r\n  const onlineCount = (group.members || []).reduce(\r\n    (sum: number, contact) => (contact.online ? sum + 1 : sum),\r\n    0\r\n  );\r\n  if (onlineCount) status.push(`${onlineCount} ${t(\"CHAT.STATUS.ONLINE\")}`);\r\n  return status.join(\", \");\r\n};\r\n\r\nconst RoomHeader: React.FC<RoomHeaderProps> = ({\r\n  apiUrl,\r\n  user,\r\n  chat,\r\n  typing,\r\n  conference,\r\n  className,\r\n  operators,\r\n  onVideoCall,\r\n  onVideoEnd,\r\n  onConferencePause,\r\n  onOperatorAdd,\r\n  onLeaveGroup,\r\n\r\n\r\n}: RoomHeaderProps) => {\r\n  const classes = useStyles();\r\n  const { t } = useTranslation();\r\n  const [anchorEl, setAnchorEl] = React.useState<HTMLElement | null>(null);\r\n  const [addOperatorOpen, setAddOperatorOpen] = React.useState(false);\r\n\r\n  if (!chat)\r\n    return (\r\n      <CardHeader\r\n        avatar={<Avatar />}\r\n        title=\"\"\r\n        subheader=\"\"\r\n        className={className}\r\n      />\r\n    );\r\n\r\n  const handlePopoverOpen = (\r\n    event: React.MouseEvent<HTMLElement, MouseEvent>\r\n  ) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  const handlePopoverClose = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  const handleAddOperatorOpen = () => {\r\n    setAddOperatorOpen(true);\r\n  };\r\n\r\n  const handleAddOperatorClose = (operator?: Contact) => {\r\n    setAddOperatorOpen(false);\r\n    if (onOperatorAdd && operator && chat)\r\n      onOperatorAdd(chat as Group, operator);\r\n  };\r\n\r\n  const group = chat as Group;\r\n  if (group.groupId) {\r\n    // группа\r\n    return (\r\n      <CardHeader\r\n        avatar={\r\n          <Avatar alt={group.name} className={classes.avatarGroup}>\r\n            <GroupIcon />{\" \"}\r\n          </Avatar>\r\n        }\r\n        title={group.name}\r\n        subheader={\r\n          <React.Fragment>\r\n            <span\r\n              aria-owns={anchorEl ? \"mouse-over-popover\" : undefined}\r\n              aria-haspopup=\"true\"\r\n              onMouseEnter={handlePopoverOpen}\r\n              onMouseLeave={handlePopoverClose}\r\n            >\r\n              {getGroupStatus(group, t)}\r\n            </span>\r\n            <Popover\r\n              id=\"mouse-over-popover\"\r\n              className={classes.popover}\r\n              classes={{\r\n                paper: classes.paper,\r\n              }}\r\n              open={!!anchorEl}\r\n              anchorEl={anchorEl}\r\n              anchorOrigin={{\r\n                vertical: \"bottom\",\r\n                horizontal: \"left\",\r\n              }}\r\n              transformOrigin={{\r\n                vertical: \"top\",\r\n                horizontal: \"left\",\r\n              }}\r\n              onClose={handlePopoverClose}\r\n              disableRestoreFocus\r\n            >\r\n              <ContactList\r\n                apiUrl={apiUrl}\r\n                contacts={group.members as Contact[]}\r\n                owner={group.userId}\r\n              />\r\n            </Popover>\r\n          </React.Fragment>\r\n        }\r\n        className={className}\r\n        action={\r\n          <React.Fragment>\r\n            {user.role === 4 && (\r\n              <React.Fragment>\r\n                <IconButton\r\n                  aria-label=\"add user\"\r\n                  onClick={handleAddOperatorOpen}\r\n                >\r\n                  <PersonAddIcon />\r\n                </IconButton>\r\n                <AddContact\r\n                  apiUrl={apiUrl}\r\n                  open={addOperatorOpen}\r\n                  contacts={operators}\r\n                  onClose={handleAddOperatorClose}\r\n                />\r\n              </React.Fragment>\r\n            )}\r\n            {user.role === 4 &&\r\n              group.members?.find(\r\n                (it) => it.userId !== user.userId && it.role === 4\r\n              ) &&\r\n              onLeaveGroup && (\r\n                <IconButton\r\n                  aria-label=\"leave group\"\r\n                  onClick={() => onLeaveGroup(group)}\r\n                >\r\n                  <DeleteIcon />\r\n                </IconButton>\r\n              )}\r\n          </React.Fragment>\r\n        }\r\n      />\r\n    );\r\n  }\r\n  const contact = chat as Contact;\r\n  const isTyping = !!typing?.contactId && typing?.userId === contact.userId;\r\n\r\n  console.log(\"conference\", conference, \"user\", user, \"contact\", contact)\r\n\r\n  return (\r\n    <CardHeader\r\n      avatar={\r\n        <Avatar alt={contact.username} src={`${apiUrl}${contact.avatar}`} />\r\n      }\r\n      title={contact.username}\r\n      subheader={<ContactStatus contact={contact} isTyping={isTyping} />}\r\n      className={className}\r\n      action={\r\n        <React.Fragment>\r\n          {conference != null && !isEmpty(conference) && onConferencePause != null && (\r\n            <Button\r\n              aria-label=\"cancel call\"\r\n              variant=\"contained\"\r\n              color=\"secondary\"\r\n              size=\"small\"\r\n              disabled={!contact.online}\r\n              startIcon={<CallEndIcon color=\"error\" />}\r\n              onClick={() => onConferencePause(conference)}\r\n            >\r\n              {t(\"CHAT.CONFERENCE.PAUSE\")}\r\n            </Button>\r\n          )}\r\n\r\n          {conference != null && !isEmpty(conference) && onVideoEnd != null && user.role != null && [3, 4].includes(user.role) && (\r\n            <Button\r\n              aria-label=\"cancel call\"\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              size=\"small\"\r\n              disabled={!contact.online}\r\n              startIcon={<CallEndIcon color=\"error\" />}\r\n              onClick={() => onVideoEnd(conference)}\r\n              style={{ marginLeft: 8 }}\r\n            >\r\n              {t(\"CHAT.CONFERENCE.FINISH\")}\r\n            </Button>\r\n          )}\r\n\r\n          {isEmpty(conference) && onVideoCall != null && user.role != null && [3, 4].includes(user.role) && (\r\n            <Button\r\n              aria-label=\"video call\"\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              size=\"small\"\r\n              disabled={!contact.online}\r\n              startIcon={<VideoCallIcon />}\r\n              onClick={() => onVideoCall(contact)}\r\n\r\n            >\r\n              {t(\"CHAT.CONFERENCE.START\")}\r\n            </Button>\r\n          )}\r\n        </React.Fragment>\r\n      }\r\n    />\r\n  );\r\n};\r\n\r\nexport default RoomHeader;\r\n","import React, { useCallback } from \"react\";\r\nimport {\r\n  Box,\r\n  Card,\r\n  CardContent,\r\n  CircularProgress,\r\n\r\n  Divider,\r\n  List,\r\n  ListItemIcon,\r\n  Menu,\r\n  MenuItem,\r\n  IconButton,\r\n} from \"@mui/material\";\r\nimport { Theme } from '@mui/material/styles';\r\nimport { makeStyles, createStyles } from '@mui/styles';\r\nimport FileCopyIcon from \"@mui/icons-material/FileCopy\";\r\nimport DeleteIcon from \"@mui/icons-material/Delete\";\r\nimport ArrowBackIcon from \"@mui/icons-material/ArrowBack\";\r\nimport Entry from \"./Entry\";\r\nimport Message from \"./Message\";\r\nimport RoomHeader from \"./RoomHeader\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { getChatId, isEmpty } from \"../utils/common\";\r\nimport {\r\n  ChatMessage,\r\n  ChatRoom,\r\n  SendMessage,\r\n  SetTyping,\r\n  User,\r\n  Contact,\r\n  ConferenceData,\r\n  Group,\r\n  ContactGather,\r\n} from \"../types\";\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    root: {\r\n      width: \"100%\",\r\n      minWidth: 360,\r\n      height: \"100%\",\r\n      display: \"flex\",\r\n      flexDirection: \"column\",\r\n    },\r\n    inline: {\r\n      display: \"inline\",\r\n    },\r\n    messageListOuter: {\r\n      flex: 1,\r\n      overflowY: \"auto\",\r\n      margin: 0,\r\n      padding: 0,\r\n      scrollbarWidth: \"thin\",\r\n      scrollbarColor: \"#6b6b6b #fff\",\r\n      \"&::-webkit-scrollbar, & *::-webkit-scrollbar\": {\r\n        backgroundColor: \"#fff\",\r\n      },\r\n      \"&::-webkit-scrollbar-thumb, & *::-webkit-scrollbar-thumb\": {\r\n        borderRadius: 8,\r\n        backgroundColor: \"#d5d9ef\",\r\n        border: \"5px solid #fff\",\r\n      },\r\n      \"&::-webkit-scrollbar-thumb:focus, & *::-webkit-scrollbar-thumb:focus\": {\r\n        backgroundColor: \"#fff\",\r\n      },\r\n      \"&::-webkit-scrollbar-thumb:active, & *::-webkit-scrollbar-thumb:active\":\r\n      {\r\n        backgroundColor: \"#73d7f5\",\r\n        border: \"3px solid #fff\",\r\n      },\r\n      \"&::-webkit-scrollbar-thumb:hover, & *::-webkit-scrollbar-thumb:hover\": {\r\n        backgroundColor: \"#73d7f5\",\r\n        border: \"3px solid #fff\",\r\n      },\r\n      \"&::-webkit-scrollbar-corner, & *::-webkit-scrollbar-corner\": {\r\n        backgroundColor: \"#fff\",\r\n      },\r\n    },\r\n    messageList: {\r\n      height: \"100%\",\r\n      overflow: \"auto\",\r\n    },\r\n    roomHeader: {\r\n      flex: 1,\r\n    },\r\n    roomProgress: {\r\n      padding: theme.spacing(2),\r\n    },\r\n    flexAll: {\r\n      flex: \"1 1 auto\",\r\n    },\r\n    flexEnd: {\r\n      justifyContent: \"flex-end\",\r\n    },\r\n  })\r\n);\r\n\r\nconst initialMenuState = {\r\n  message: null,\r\n  mouseX: null,\r\n  mouseY: null,\r\n  canCopy: false,\r\n  canDelete: false,\r\n};\r\n\r\nconst initialScrollState = {\r\n  autoScroll: true,\r\n  height: 0,\r\n};\r\n\r\ntype RoomProps = {\r\n  apiUrl: string;\r\n  user: User;\r\n  users: ContactGather;\r\n  chat: ChatRoom | null;\r\n  typing: SetTyping | null;\r\n  conference: ConferenceData | null;\r\n  loading: boolean;\r\n  pageSize: number;\r\n  operators: Contact[];\r\n  onExitRoom?: (chat: ChatRoom) => void;\r\n  onEnterRoom?: (chat: ChatRoom) => void;\r\n  onNeedMoreMessages: (chat: ChatRoom) => Promise<void>;\r\n  onMeesageDelete?: (chat: ChatRoom, message: ChatMessage) => void;\r\n  onTyping?: (chat: ChatRoom) => void;\r\n  onSendMessage?: (chat: ChatRoom, data: SendMessage) => void;\r\n  onVideoCall?: (chat: ChatRoom) => void;\r\n  onVideoEnd?: (chat: ConferenceData) => void;\r\n  onConferencePause?: (conference: ConferenceData) => void;\r\n  onOperatorAdd?: (chat: Group, operator: Contact) => void;\r\n  onLeaveGroup?: (chat: Group) => void;\r\n\r\n};\r\n\r\nconst Room: React.FC<RoomProps> = (props: RoomProps) => {\r\n  const { apiUrl, user, users, chat, typing, conference, loading, pageSize } =\r\n    props;\r\n  const classes = useStyles();\r\n  const { t } = useTranslation();\r\n\r\n  const [scrollState, setScrollState] = React.useState(initialScrollState);\r\n\r\n  const messages = chat?.messages;\r\n  const messageCount = messages?.length || 0;\r\n\r\n  const refOnLastMess = React.useRef<HTMLDivElement>(null);\r\n  const refList = React.useRef<HTMLUListElement>(null);\r\n\r\n  const [menuState, setMenuState] = React.useState<{\r\n    message: ChatMessage | null;\r\n    mouseX: null | number;\r\n    mouseY: null | number;\r\n    canCopy: boolean;\r\n    canDelete: boolean;\r\n  }>(initialMenuState);\r\n\r\n  React.useEffect(() => {\r\n    if (props.onEnterRoom && chat) props.onEnterRoom(chat);\r\n  }, [getChatId(chat)]);\r\n\r\n  React.useLayoutEffect(() => {\r\n    if (scrollState.autoScroll && refOnLastMess.current) {\r\n      refOnLastMess.current.scrollIntoView();\r\n    }\r\n  }, [getChatId(chat), messageCount]);\r\n\r\n  React.useLayoutEffect(() => {\r\n    if (!loading && refList.current && scrollState.height > 0) {\r\n      refList.current.scrollTop =\r\n        refList.current.scrollHeight - scrollState.height;\r\n      setScrollState(initialScrollState);\r\n    }\r\n  }, [getChatId(chat), loading, scrollState.height]);\r\n\r\n  const onScroll = React.useCallback(\r\n    async (event: React.UIEvent<HTMLUListElement>) => {\r\n      const { currentTarget } = event;\r\n      if (!currentTarget || !chat || !!chat.noMoreData) return;\r\n      if (currentTarget.scrollTop === 0) {\r\n        if (messageCount >= pageSize && !loading && props.onNeedMoreMessages) {\r\n          setScrollState({\r\n            autoScroll: false,\r\n            height: currentTarget.scrollHeight,\r\n          });\r\n          props.onNeedMoreMessages(chat);\r\n        }\r\n      }\r\n    },\r\n    [chat, loading]\r\n  );\r\n\r\n  const handleMenuPopup = (\r\n    message: ChatMessage,\r\n    event: React.MouseEvent<HTMLElement>\r\n  ) => {\r\n    const canCopy = message.messageType === \"text\";\r\n    const canDelete =\r\n      user.userId === message.userId &&\r\n      !!props.onMeesageDelete &&\r\n      new Date().getTime() - new Date(message.cdate).getTime() <= 1000 * 60 * 2;\r\n    if (!canCopy && !canDelete) {\r\n      setMenuState(initialMenuState);\r\n      return;\r\n    }\r\n    event.preventDefault();\r\n    setMenuState({\r\n      message,\r\n      mouseX: event.clientX - 2,\r\n      mouseY: event.clientY - 4,\r\n      canCopy,\r\n      canDelete,\r\n    });\r\n  };\r\n\r\n  const handleMenuClose = () => {\r\n    setMenuState(initialMenuState);\r\n  };\r\n\r\n  const handleCopy = useCallback(() => {\r\n    const { message } = menuState;\r\n    setMenuState(initialMenuState);\r\n    if (!message) return;\r\n    navigator.clipboard.writeText(message.content);\r\n  }, [menuState.message]);\r\n\r\n  const handleDelete = useCallback(() => {\r\n    const { message } = menuState;\r\n    setMenuState(initialMenuState);\r\n    if (props.onMeesageDelete && chat && message)\r\n      props.onMeesageDelete(chat, message);\r\n  }, [menuState.message]);\r\n\r\n  console.log(\"messages\", messages)\r\n\r\n  return (\r\n    <Card elevation={1} className={classes.root}>\r\n      <Box display=\"flex\" flexDirection=\"row\">\r\n        {props.onExitRoom && chat && (\r\n          <IconButton\r\n            aria-label=\"exit room\"\r\n            onClick={() => props.onExitRoom && props.onExitRoom(chat)}\r\n          >\r\n            <ArrowBackIcon />\r\n          </IconButton>\r\n        )}\r\n        <RoomHeader\r\n          apiUrl={apiUrl}\r\n          user={user}\r\n          chat={chat}\r\n          typing={typing}\r\n          conference={conference}\r\n          operators={props.operators}\r\n          className={classes.roomHeader}\r\n          onVideoCall={props.onVideoCall}\r\n          onVideoEnd={props.onVideoEnd}\r\n          onConferencePause={props.onConferencePause}\r\n          onOperatorAdd={props.onOperatorAdd}\r\n          onLeaveGroup={props.onLeaveGroup}\r\n        />\r\n        {loading && (\r\n          <div className={classes.roomProgress}>\r\n            <CircularProgress size={20} />\r\n          </div>\r\n        )}\r\n      </Box>\r\n      <Divider />\r\n      <CardContent className={classes.messageListOuter}>\r\n        {!isEmpty(messages) ? (\r\n          <List className={classes.messageList} onScroll={onScroll}>\r\n            {messages != null &&\r\n              (messages as ChatMessage[]).map((message, inx) => (\r\n                <Message\r\n                  key={message._id}\r\n                  apiUrl={apiUrl}\r\n                  user={user}\r\n                  message={message}\r\n                  owner={users[message.userId]}\r\n                  isGroupMessage={!!chat?.groupId}\r\n                  isUserFirst={\r\n                    inx === 0 ||\r\n                    messages[inx - 1].messageType === \"notify\" ||\r\n                    messages[inx - 1].userId !== messages[inx].userId\r\n                  }\r\n                  isUserLast={\r\n                    inx === messages.length - 1 ||\r\n                    messages[inx + 1].messageType === \"notify\" ||\r\n                    messages[inx + 1].userId !== messages[inx].userId\r\n                  }\r\n                  onContextMenu={(event) => handleMenuPopup(message, event)}\r\n                  refOnLastMess={\r\n                    inx === messages.length - 1 ? refOnLastMess : null\r\n                  }\r\n                />\r\n              ))}\r\n          </List>\r\n        ) : null}\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent>\r\n        <Entry\r\n          chat={chat}\r\n          onTyping={props.onTyping}\r\n          onSendMessage={props.onSendMessage}\r\n        />\r\n      </CardContent>\r\n      <Menu\r\n        keepMounted\r\n        open={menuState.mouseY !== null}\r\n        onClose={handleMenuClose}\r\n        anchorReference=\"anchorPosition\"\r\n        anchorPosition={\r\n          menuState.mouseY !== null && menuState.mouseX !== null\r\n            ? { top: menuState.mouseY, left: menuState.mouseX }\r\n            : undefined\r\n        }\r\n      >\r\n        <MenuItem onClick={handleCopy} disabled={!menuState.canCopy}>\r\n          <span className={classes.flexAll}>{t(\"CHAT.MESSAGE.MENU.COPY\")}</span>\r\n          <ListItemIcon className={classes.flexEnd}>\r\n            <FileCopyIcon fontSize=\"small\" />\r\n          </ListItemIcon>\r\n        </MenuItem>\r\n        <MenuItem onClick={handleDelete} disabled={!menuState.canDelete}>\r\n          <span className={classes.flexAll}>\r\n            {t(\"CHAT.MESSAGE.MENU.DELETE\")}\r\n          </span>\r\n          <ListItemIcon className={classes.flexEnd}>\r\n            <DeleteIcon fontSize=\"small\" />\r\n          </ListItemIcon>\r\n        </MenuItem>\r\n      </Menu>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default Room;\r\n","import React from \"react\";\r\nimport {\r\n  Avatar,\r\n  Badge,\r\n  Box,\r\n  Chip,\r\n  ListItem,\r\n  ListItemAvatar,\r\n  ListItemText,\r\n} from \"@mui/material\";\r\nimport { Theme } from '@mui/material/styles';\r\nimport { makeStyles, createStyles, withStyles } from '@mui/styles';\r\n\r\nimport GroupIcon from \"@mui/icons-material/Group\";\r\nimport { formatTime, getChatName } from \"../utils/common\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { ChatMessage, ChatRoom, Contact, Group, SetTyping } from \"../types\";\r\n\r\ntype RoomListItemProps = {\r\n  apiUrl: string;\r\n  chat: ChatRoom;\r\n  active: boolean;\r\n  typing: SetTyping | null;\r\n  onClick: React.MouseEventHandler<HTMLDivElement> | undefined;\r\n};\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    main: {\r\n      flex: \"1 1 auto\",\r\n      whiteSpace: \"nowrap\",\r\n      overflow: \"hidden\",\r\n      textOverflow: \"ellipsis\",\r\n    },\r\n    time: {\r\n      paddingLeft: theme.spacing(1),\r\n      justifyContent: \"flex-end\",\r\n      whiteSpace: \"nowrap\",\r\n    },\r\n    unread: {\r\n      justifyContent: \"flex-end\",\r\n      maxHeight: 20,\r\n    },\r\n    avatarGroup: {\r\n      backgroundColor: \"#28B7C6\",\r\n      color: \"#fff\",\r\n    },\r\n  })\r\n);\r\n\r\nconst getMessageText = (\r\n  message: ChatMessage | null,\r\n  t: (key: string) => string\r\n) => {\r\n  if (!message) return null;\r\n  switch (message.messageType) {\r\n    case \"text\":\r\n      return message.content;\r\n    case \"image\":\r\n      return `[${t(\"CHAT.MESSAGE.TYPE.IMAGE\")}]`;\r\n    case \"video\":\r\n      return `[${t(\"CHAT.MESSAGE.TYPE.VIDEO\")}]`;\r\n    case \"file\":\r\n      return `[${t(\"CHAT.MESSAGE.TYPE.FILE\")}]`;\r\n    case \"notify\":\r\n      return `[${t(\"CHAT.MESSAGE.TYPE.NOTIFY\")}]`;\r\n    default:\r\n      return null;\r\n  }\r\n};\r\n\r\nconst TypingBadge = withStyles((theme: Theme) =>\r\n  createStyles({\r\n    badge: {\r\n      backgroundColor: \"#44b700\",\r\n      color: \"#44b700\",\r\n      boxShadow: `0 0 0 2px ${theme.palette.background.paper}`,\r\n      \"&::after\": {\r\n        position: \"absolute\",\r\n        top: 0,\r\n        left: 0,\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n        borderRadius: \"50%\",\r\n        animation: \"$ripple 1.2s infinite ease-in-out\",\r\n        border: \"1px solid currentColor\",\r\n        content: '\"\"',\r\n      },\r\n    },\r\n    \"@keyframes ripple\": {\r\n      \"0%\": {\r\n        transform: \"scale(.8)\",\r\n        opacity: 1,\r\n      },\r\n      \"100%\": {\r\n        transform: \"scale(2.4)\",\r\n        opacity: 0,\r\n      },\r\n    },\r\n  })\r\n)(Badge);\r\n\r\nconst OnlineBadge = withStyles((theme: Theme) =>\r\n  createStyles({\r\n    badge: {\r\n      backgroundColor: theme.palette.primary.main,\r\n      boxShadow: `0 0 0 2px ${theme.palette.background.paper}`,\r\n    },\r\n  })\r\n)(Badge);\r\n\r\nconst contactAvatar = (\r\n  apiUrl: string,\r\n  contact: Contact,\r\n  typing: SetTyping | null\r\n): JSX.Element => {\r\n  const avatar = (\r\n    <Avatar alt={contact.username} src={`${apiUrl}${contact.avatar}`} />\r\n  );\r\n\r\n  const isTyping = !!typing?.contactId && typing?.userId === contact.userId;\r\n  if (isTyping)\r\n    return (\r\n      <TypingBadge\r\n        overlap=\"circular\"\r\n        anchorOrigin={{\r\n          vertical: \"bottom\",\r\n          horizontal: \"right\",\r\n        }}\r\n        variant=\"dot\"\r\n      >\r\n        {avatar}\r\n      </TypingBadge>\r\n    );\r\n\r\n  if (contact?.online)\r\n    return (\r\n      <OnlineBadge\r\n        overlap=\"circular\"\r\n        anchorOrigin={{\r\n          vertical: \"bottom\",\r\n          horizontal: \"right\",\r\n        }}\r\n        variant=\"dot\"\r\n      >\r\n        {avatar}\r\n      </OnlineBadge>\r\n    );\r\n\r\n  return avatar;\r\n};\r\n\r\nconst RoomListItem: React.FC<RoomListItemProps> = (\r\n  props: RoomListItemProps\r\n) => {\r\n  const classes = useStyles();\r\n  const { t } = useTranslation();\r\n  const { apiUrl, chat, typing } = props;\r\n  const roomName = getChatName(chat);\r\n\r\n  const avatar = (chat as Group).groupId ? (\r\n    <Avatar alt={roomName} className={classes.avatarGroup}>\r\n      <GroupIcon />{\" \"}\r\n    </Avatar>\r\n  ) : (\r\n    contactAvatar(apiUrl, chat as Contact, typing)\r\n  );\r\n\r\n  const lastMessage =\r\n    chat.messages && chat.messages.length > 0\r\n      ? chat.messages[chat.messages.length - 1]\r\n      : null;\r\n\r\n  const roomText = getMessageText(lastMessage, t);\r\n  const roomTime = lastMessage?.cdate;\r\n\r\n  return (\r\n    <ListItem button selected={props.active} onClick={props.onClick}>\r\n      <ListItemAvatar>{avatar}</ListItemAvatar>\r\n      <ListItemText\r\n        secondaryTypographyProps={{ component: \"span\" }}\r\n        primary={\r\n          <Box display=\"flex\" flexDirection=\"row\">\r\n            <span className={classes.main}>{roomName}</span>\r\n            <span className={classes.time}>{formatTime(roomTime)}</span>\r\n          </Box>\r\n        }\r\n        secondary={\r\n          <Box display=\"flex\" flexDirection=\"row\">\r\n            <span className={classes.main}>{roomText}</span>\r\n            {chat.unreadCount ? (\r\n              <Chip\r\n                className={classes.unread}\r\n                component=\"span\"\r\n                size=\"small\"\r\n                color=\"primary\"\r\n                label={chat.unreadCount}\r\n              />\r\n            ) : null}\r\n          </Box>\r\n        }\r\n      />\r\n    </ListItem>\r\n  );\r\n};\r\nexport default RoomListItem;\r\n","import React, { useEffect } from \"react\";\r\nimport List from \"@mui/material/List\";\r\nimport { Card, CardHeader, Divider, TextField } from \"@mui/material\";\r\nimport RoomListItem from \"./RoomListItem\";\r\nimport {\r\n  chatRoomComparer,\r\n  getChatId,\r\n  getChatName,\r\n  isEmpty,\r\n} from \"../utils/common\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { ChatRoom, Contact, Group, SetTyping, User } from \"../types\";\r\nimport { makeStyles } from '@mui/styles';\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n  },\r\n  searchField: {\r\n    width: \"100%\",\r\n  },\r\n}));\r\n\r\ntype RoomListProps = {\r\n  apiUrl: string;\r\n  user: User;\r\n  activeRoom: ChatRoom | null;\r\n  groups: Group[];\r\n  contacts: Contact[];\r\n  typing: SetTyping | null;\r\n  onChangeChat?: (chat: ChatRoom) => void;\r\n};\r\n\r\nconst filterChats = (chats: ChatRoom[], filter: string | null): ChatRoom[] => {\r\n  if (filter === null) return chats;\r\n  const lowerFilter = filter.toLowerCase();\r\n  return chats.filter(\r\n    (chat) =>\r\n      getChatName(chat).toLowerCase().indexOf(lowerFilter.toLowerCase()) !== -1\r\n  );\r\n};\r\n\r\nconst sortChats = (\r\n  userId: number,\r\n  groups: ChatRoom[],\r\n  contacts: ChatRoom[]\r\n) => {\r\n  let roomArr = [...groups, ...contacts];\r\n\r\n  // Сортировать окно чата (по времени последних сообщений)\r\n  roomArr = roomArr.sort(chatRoomComparer);\r\n\r\n  // Проверяем, есть ли список, который нужно закрепить\r\n  const topChatId = localStorage.getItem(`${userId}-topChatId`) as string;\r\n  if (topChatId) {\r\n    const chat = roomArr.find((c) => getChatId(c) === topChatId);\r\n    if (chat) {\r\n      // На первое место\r\n      roomArr = roomArr.filter((k) => getChatId(k) !== topChatId);\r\n      chat.isTop = true;\r\n      roomArr.unshift(chat);\r\n    }\r\n  }\r\n\r\n  return roomArr;\r\n};\r\n\r\nconst RoomList: React.FC<RoomListProps> = (props: RoomListProps) => {\r\n  const classes = useStyles();\r\n  const { t } = useTranslation();\r\n\r\n  const [chats, setChats] = React.useState<ChatRoom[]>([]);\r\n\r\n  useEffect(() => {\r\n    setChats(\r\n      sortChats(\r\n        props.user.userId,\r\n        filterChats(props.groups, null),\r\n        filterChats(props.contacts, null)\r\n      )\r\n    );\r\n  }, []);\r\n\r\n  const onSearchChange = (e: React.ChangeEvent<HTMLInputElement>): void => {\r\n    //    console.log(\"e.target.value\", e.target.value);\r\n\r\n    setChats(\r\n      sortChats(\r\n        props.user.userId,\r\n        filterChats(props.groups, e.target.value),\r\n        filterChats(props.contacts, e.target.value)\r\n      )\r\n    );\r\n  };\r\n\r\n  //console.log('props.activeRoom ==', props.activeRoom);\r\n  //const activeItem = (id: number) => id === props.activeRoom?.userId;\r\n  return (\r\n    <Card elevation={1} className={classes.root}>\r\n      <CardHeader\r\n        title={\r\n          <TextField\r\n            className={classes.searchField}\r\n            label={t(\"CHAT.INPUT_SEARCH_CONTACT\")}\r\n            variant=\"outlined\"\r\n            size=\"small\"\r\n            fullWidth\r\n            onChange={onSearchChange}\r\n          />\r\n        }\r\n      />\r\n      <Divider />\r\n      <List component=\"nav\" aria-label=\"rooms\">\r\n        {!isEmpty(chats) &&\r\n          chats.map((chat) => (\r\n            <RoomListItem\r\n              key={getChatId(chat)}\r\n              apiUrl={props.apiUrl}\r\n              chat={chat}\r\n              active={chat === props.activeRoom}\r\n              typing={props.typing}\r\n              onClick={() =>\r\n                props.onChangeChat != null && props.onChangeChat(chat)\r\n              }\r\n            />\r\n          ))}\r\n      </List>\r\n    </Card>\r\n  );\r\n};\r\nexport default RoomList;\r\n","import React, { useEffect } from \"react\";\r\nimport { makeStyles } from '@mui/styles';\r\nimport { ConferenceData } from \"../types\";\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    borderRadius: 8,\r\n  },\r\n}));\r\n\r\ntype ConferenceProps = {\r\n  conference: ConferenceData | null;\r\n  onClose: (conference: ConferenceData | null) => void;\r\n};\r\n\r\nconst Conference: React.FC<ConferenceProps> = ({\r\n  conference,\r\n  onClose,\r\n}: ConferenceProps) => {\r\n  const classes = useStyles();\r\n  const ref = React.useRef<HTMLIFrameElement>(null);\r\n\r\n  useEffect(() => {\r\n\r\n    const listener = ({ source, data }: MessageEvent) => {\r\n      if (source === ref.current?.contentWindow) {\r\n        const { type } = data;\r\n        if (\r\n          [\r\n            \"notSupported\",\r\n            \"connectionFail\",\r\n            // \"loginFail\",\r\n            \"callFail\",\r\n            \"hangUp\",\r\n            \"remoteHangUp\",\r\n            // \"onParticipantLeft\"\r\n          ].includes(type)\r\n        )\r\n          onClose(conference);\r\n      }\r\n    };\r\n    window.addEventListener(\"message\", listener);\r\n    return () => {\r\n      window.removeEventListener(\"message\", listener);\r\n    };\r\n  }, [conference?.id]);\r\n\r\n  return (\r\n    <iframe\r\n      title=\"conference\"\r\n      className={classes.root}\r\n      src={conference?.url}\r\n      allowFullScreen\r\n      allow=\"microphone; camera; autoplay; display-capture\"\r\n      ref={ref}\r\n    />\r\n  );\r\n};\r\nexport default Conference;\r\n","import React from \"react\";\r\nimport { Avatar, Button,  Paper } from \"@mui/material\";\r\nimport { ConferenceData, Contact } from \"../types\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { makeStyles } from '@mui/styles';\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    borderRadius: 8,\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n  },\r\n  pulse: {\r\n    height: 100,\r\n    width: 100,\r\n    borderRadius: \"50%\",\r\n    display: \"flex\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    position: \"relative\",\r\n    \"&::before\": {\r\n      content: \"''\",\r\n      position: \"absolute\",\r\n      border: \"1px solid green\",\r\n      width: \"calc(100% + 40px)\",\r\n      height: \"calc(100% + 40px)\",\r\n      borderRadius: \"50%\",\r\n      animation: \"$pulse 1s linear infinite\",\r\n    },\r\n    \"&::after\": {\r\n      content: \"''\",\r\n      position: \"absolute\",\r\n      border: \"1px solid green\",\r\n      width: \"calc(100% + 40px)\",\r\n      height: \"calc(100% + 40px)\",\r\n      borderRadius: \"50%\",\r\n      animation: \"$pulse 1s linear infinite\",\r\n      animationDelay: \"0.3s\",\r\n    },\r\n  },\r\n  avatar: {\r\n    width: \"80%\",\r\n    height: \"80%\",\r\n  },\r\n  footer: {\r\n    width: \"100%\",\r\n    alignSelf: \"flex-end\",\r\n    paddingTop: 64,\r\n    display: \"flex\",\r\n    justifyContent: \"center\",\r\n  },\r\n  \"@keyframes pulse\": {\r\n    \"0%\": {\r\n      transform: \"scale(0.5)\",\r\n      opacity: 0,\r\n    },\r\n    \"50%\": {\r\n      transform: \"scale(1)\",\r\n      opacity: 1,\r\n    },\r\n    \"100%\": {\r\n      transform: \"scale(1.3)\",\r\n      opacity: 0,\r\n    },\r\n  },\r\n}));\r\n\r\ntype ConferenceCallProps = {\r\n  conference: ConferenceData;\r\n  contact: Contact;\r\n  apiUrl: string;\r\n  onAccept: (conference: ConferenceData) => void;\r\n};\r\n\r\nconst ConferenceCall: React.FC<ConferenceCallProps> = ({\r\n  conference,\r\n  contact,\r\n  apiUrl,\r\n  onAccept,\r\n}: ConferenceCallProps) => {\r\n  const classes = useStyles();\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <Paper className={classes.root}>\r\n      <div className={classes.pulse}>\r\n        {contact ? (\r\n          <Avatar\r\n            className={classes.avatar}\r\n            alt={contact.username}\r\n            src={`${apiUrl}${contact.avatar}`}\r\n          />\r\n        ) : (\r\n          <Avatar className={classes.avatar} />\r\n        )}\r\n      </div>\r\n      <div className={classes.footer}>\r\n        <Button\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          onClick={() => onAccept(conference)}\r\n        >\r\n          {t(\"CHAT.CONFERENCE.JOIN\")}\r\n        </Button>\r\n      </div>\r\n    </Paper>\r\n  );\r\n};\r\n\r\nexport default ConferenceCall;\r\n","import React from \"react\";\r\nimport {\r\n  AddGroupMessages,\r\n  AddPrivateMessages,\r\n  ChatRoom,\r\n  Contact,\r\n  ContactGather,\r\n  Group,\r\n  GroupGather,\r\n  GroupMember,\r\n  GroupMessage,\r\n  MessageOperation,\r\n  PrivateMessage,\r\n  SetActiveRoom,\r\n  //SetUser,\r\n  SetTyping,\r\n  User,\r\n  ConferenceData,\r\n  GroupMap,\r\n} from \"../types\";\r\nimport { chatRoomComparer } from \"../utils/common\";\r\n\r\nexport interface ChatState {\r\n  tokenKey: string;\r\n  user: User;\r\n  token: string;\r\n  activeRoom: ChatRoom | null;\r\n  groupGather: GroupGather;\r\n  userGather: ContactGather;\r\n  contactGather: ContactGather;\r\n  operators: Contact[];\r\n  initialContactId: number | null;\r\n  conference: {\r\n    data: ConferenceData | null;\r\n    joined: boolean;\r\n    ringPlayed: boolean;\r\n  };\r\n  typing: SetTyping | null;\r\n  loading: boolean;\r\n  error?: string;\r\n}\r\n\r\nconst emptyUser: User = {\r\n  userId: 0,\r\n  username: \"\",\r\n  password: \"\",\r\n  avatar: \"\",\r\n  langCode: \"\",\r\n};\r\n\r\nconst emptyChatState: ChatState = {\r\n  tokenKey: \"\", // ключ, где хранить токен\r\n  user: emptyUser, // пользователь\r\n  token: \"\", // токен\r\n  activeRoom: null, // активная комната\r\n  groupGather: {}, // список групп\r\n  userGather: {}, // список онлайн\r\n  contactGather: {}, // контакты\r\n  operators: [], // операторы\r\n  initialContactId: null, // начальный контакт\r\n  conference: {\r\n    data: null, // данные конференции\r\n    joined: false,\r\n    ringPlayed: false,\r\n  },\r\n  typing: null, // кто печатает текст\r\n  loading: false, // загрузка данных\r\n  error: undefined, // ошибка\r\n};\r\n\r\ntype ChatActionType =\r\n  | \"ADD_GROUP_MEMBER\"\r\n  | \"ADD_GROUP_MESSAGE\"\r\n  | \"ADD_GROUP_MESSAGES\"\r\n  | \"SET_GROUP_MESSAGES\"\r\n  | \"ADD_PRIVATE_MESSAGE\"\r\n  | \"ADD_PRIVATE_MESSAGES\"\r\n  | \"SET_PRIVATE_MESSAGES\"\r\n  | \"SET_ACTIVE_ROOM\"\r\n  | \"UPDATE_ACTIVE_ROOM\"\r\n  | \"SET_GROUP_GATHER\"\r\n  | \"SET_CONTACT_GATHER\"\r\n  | \"SET_USER_GATHER\"\r\n  | \"DEL_GROUP\"\r\n  | \"DEL_GROUP_MEMBER\"\r\n  | \"DEL_CONTACT\"\r\n  | \"ADD_CONTACT_UNREAD_GATHER\"\r\n  | \"LOSE_CONTACT_UNREAD_GATHER\"\r\n  | \"ADD_GROUP_UNREAD_GATHER\"\r\n  | \"LOSE_GROUP_UNREAD_GATHER\"\r\n  | \"REVOKE_MESSAGE\"\r\n  | \"USER_ONLINE\"\r\n  | \"USER_OFFLINE\"\r\n  | \"UPDATE_USER_INFO\"\r\n  | \"SET_INITIAL_CONTACT_ID\"\r\n  | \"SET_CONFERENCE\"\r\n  | \"JOIN_CONFERENCE\"\r\n  | \"PAUSE_CONFERENCE\"\r\n  | \"STOP_CONFERENCE\"\r\n  | \"SET_TYPING\"\r\n  | \"MARK_AS_READ\"\r\n  | \"UPDATE_GROUP_INFO\"\r\n  | \"MARK_PRIVATE_MESSAGES_READ\"\r\n  | \"SET_LOADING\"\r\n  | \"SET_ERROR\"\r\n  | \"SET_USER\"\r\n  | \"SET_TOKEN\"\r\n  | \"CLEAR_USER\"\r\n  | \"CLEAR_CHAT_DATA\"\r\n  | \"SET_OPERATORS\";\r\n\r\ntype Action = {\r\n  type: ChatActionType;\r\n  payload?:\r\n  | null\r\n  | boolean\r\n  | number\r\n  | string\r\n  | Group\r\n  | Contact\r\n  | User\r\n  | PrivateMessage\r\n  | GroupMessage\r\n  | SetTyping\r\n  | MessageOperation\r\n  | GroupMember\r\n  | AddPrivateMessages\r\n  | AddGroupMessages\r\n  | SetActiveRoom\r\n  | ConferenceData\r\n  | Contact[]\r\n  | GroupMap;\r\n};\r\n\r\nconst getFreshActiveRoom = (state: ChatState) => {\r\n  if (state.activeRoom)\r\n    return (\r\n      state.groupGather[(state.activeRoom as Group).groupId] ||\r\n      state.contactGather[state.activeRoom.userId]\r\n    );\r\n  return null;\r\n};\r\n\r\nconst getActiveRoom = (state: ChatState) => {\r\n  const { activeRoom, initialContactId, contactGather } = state;\r\n  let newActiveRoom: ChatRoom | null = null;\r\n  if (initialContactId) {\r\n    newActiveRoom = contactGather[initialContactId];\r\n  } else if (activeRoom) {\r\n    newActiveRoom = getFreshActiveRoom(state);\r\n  } else {\r\n    // ищем комнату с самым свежим сообщением\r\n    const rooms = [\r\n      ...Object.values(state.contactGather),\r\n      ...Object.values(state.groupGather),\r\n    ].sort(chatRoomComparer);\r\n    if (rooms.length > 0) newActiveRoom = rooms[0];\r\n  }\r\n  return newActiveRoom;\r\n};\r\n\r\nconst setUserOnline = (\r\n  state: ChatState,\r\n  userId: number,\r\n  online: 0 | 1\r\n): ChatState => {\r\n  const newState = { ...state };\r\n  // Обновить статусы приватных чатов\r\n  if (state.contactGather[userId])\r\n    newState.contactGather[userId] = {\r\n      ...newState.contactGather[userId],\r\n      online,\r\n    };\r\n\r\n  // Обновить статус участника в группах\r\n  for (const group of Object.values(state.groupGather) as Group[]) {\r\n    if (!group.members) continue;\r\n    const member = group.members.find((m) => m.userId === userId);\r\n    if (member) {\r\n      const index = group.members.indexOf(member);\r\n      group.members[index] = { ...member, online };\r\n    }\r\n  }\r\n  // Обновить статус операторов\r\n  const idx = newState.operators.findIndex((it) => it.userId === userId);\r\n  if (idx !== -1)\r\n    newState.operators[idx] = { ...newState.operators[idx], online };\r\n  // обновляем активный чат\r\n  newState.activeRoom = getFreshActiveRoom(newState);\r\n  return newState;\r\n};\r\n\r\nconst addGroupMessage = (state: ChatState, payload: GroupMessage) => {\r\n  const newState = { ...state };\r\n  const { groupId } = payload;\r\n  if (newState.groupGather[groupId]) {\r\n    if (newState.groupGather[groupId].messages) {\r\n      newState.groupGather[groupId].messages = [\r\n        ...(newState.groupGather[groupId].messages as GroupMessage[]),\r\n        payload,\r\n      ];\r\n    } else {\r\n      newState.groupGather[groupId] = {\r\n        ...state.groupGather[groupId],\r\n        messages: [payload],\r\n      };\r\n    }\r\n  }\r\n\r\n  // увеличиваем счетчик новых сообщений, если это не активная комната и сообщение не от нас\r\n  const { activeRoom } = newState;\r\n  if (\r\n    activeRoom &&\r\n    (activeRoom as Group).groupId !== groupId &&\r\n    payload.userId !== state.user.userId\r\n  ) {\r\n    return groupUnreadGather(newState, groupId, (x?: number) => (x || 0) + 1);\r\n  }\r\n\r\n  // обновляем активный чат\r\n  newState.activeRoom = getFreshActiveRoom(newState);\r\n  return newState;\r\n};\r\n\r\nconst addPrivateMessage = (state: ChatState, payload: PrivateMessage) => {\r\n  const newState = { ...state };\r\n  const contactId =\r\n    payload.contactId === state.user.userId\r\n      ? payload.userId\r\n      : payload.contactId;\r\n\r\n  // 1 добавляем сообщение\r\n  if (newState.contactGather[contactId].messages) {\r\n    newState.contactGather[contactId].messages = [\r\n      ...(newState.contactGather[contactId].messages as PrivateMessage[]),\r\n      payload,\r\n    ];\r\n  } else {\r\n    newState.contactGather[contactId] = {\r\n      ...newState.contactGather[contactId],\r\n      messages: [payload],\r\n    };\r\n  }\r\n\r\n  // 2 если это сообщение в неактивной комнате и источник не мы (в соседней вкладке), то увеличиваем счетчик непрочитанных\r\n  if (\r\n    newState.activeRoom?.userId !== contactId &&\r\n    payload.userId !== state.user.userId\r\n  ) {\r\n    return contactUnreadGather(\r\n      newState,\r\n      contactId,\r\n      (x?: number) => (x || 0) + 1\r\n    );\r\n  }\r\n\r\n  // обновляем активный чат\r\n  newState.activeRoom = getFreshActiveRoom(newState);\r\n  return newState;\r\n};\r\n\r\nconst contactUnreadGather = (\r\n  state: ChatState,\r\n  userId: number,\r\n  predicate: (x?: number) => number\r\n) => {\r\n  const newState = { ...state };\r\n\r\n  if (newState.contactGather[userId]) {\r\n    newState.contactGather[userId] = {\r\n      ...newState.contactGather[userId],\r\n      unreadCount: predicate(newState.contactGather[userId].unreadCount),\r\n    };\r\n  }\r\n\r\n  // обновляем активный чат\r\n  newState.activeRoom = getFreshActiveRoom(newState);\r\n\r\n  return newState;\r\n};\r\n\r\nconst groupUnreadGather = (\r\n  state: ChatState,\r\n  groupId: number,\r\n  predicate: (x?: number) => number\r\n) => {\r\n  const newState = { ...state };\r\n\r\n  if (newState.groupGather[groupId]) {\r\n    newState.groupGather[groupId] = {\r\n      ...newState.groupGather[groupId],\r\n      unreadCount: predicate(newState.groupGather[groupId].unreadCount),\r\n    };\r\n  }\r\n\r\n  // обновляем активный чат\r\n  newState.activeRoom = getFreshActiveRoom(newState);\r\n\r\n  return newState;\r\n};\r\n\r\nconst revokeMessage = (state: ChatState, payload: MessageOperation) => {\r\n  const { userId } = state.user;\r\n  const newState = { ...state };\r\n  const userName =\r\n    payload.username || newState.userGather[payload.userId as number].username;\r\n  if (payload.groupId) {\r\n    const { messages } = newState.groupGather[payload.groupId];\r\n    // задаем isRevoke\r\n    if (messages) {\r\n      const msg = messages.find((message) => message._id === payload._id);\r\n      if (msg) {\r\n        const index = messages.indexOf(msg);\r\n        messages[index] = {\r\n          ...msg,\r\n          isRevoke: true,\r\n          revokeUserName: userName,\r\n        };\r\n      }\r\n    }\r\n  } else {\r\n    const { messages } =\r\n      newState.contactGather[\r\n      payload.contactId === userId\r\n        ? (payload.userId as number)\r\n        : (payload.contactId as number)\r\n      ];\r\n    // задаем isRevoke\r\n    if (messages) {\r\n      const msg = messages.find((message) => message._id === payload._id);\r\n      if (msg) {\r\n        const index = messages.indexOf(msg);\r\n        messages[index] = {\r\n          ...msg,\r\n          isRevoke: true,\r\n          revokeUserName: userName,\r\n        };\r\n      }\r\n    }\r\n  }\r\n  // обновляем активный чат\r\n  newState.activeRoom = getFreshActiveRoom(newState);\r\n  return newState;\r\n};\r\n\r\nconst delContact = (state: ChatState, userId: number) => {\r\n  const newState = { ...state };\r\n  const updateActiveRoom =\r\n    newState.activeRoom === newState.contactGather[userId];\r\n  delete newState.contactGather[userId];\r\n  if (updateActiveRoom) newState.activeRoom = getActiveRoom(newState);\r\n\r\n  return newState;\r\n};\r\n\r\nconst delGroup = (state: ChatState, groupId: number) => {\r\n  const newState = { ...state };\r\n  const updateActiveRoom =\r\n    newState.activeRoom === newState.groupGather[groupId];\r\n  delete newState.groupGather[groupId];\r\n  if (updateActiveRoom) newState.activeRoom = getActiveRoom(newState);\r\n\r\n  return newState;\r\n};\r\n\r\nconst delGroupMember = (state: ChatState, data: GroupMap) => {\r\n  const newState = { ...state };\r\n\r\n  const group = newState.groupGather[data.groupId];\r\n  if (group) {\r\n    group.members = group.members?.filter((it) => it.userId !== data.userId);\r\n  }\r\n\r\n  return newState;\r\n};\r\n\r\nconst updateGroupInfo = (state: ChatState, group: Group) => {\r\n  const newState = { ...state };\r\n\r\n  const { groupId, name, notice } = group;\r\n  const info = newState.groupGather[groupId];\r\n  if (info) {\r\n    newState.groupGather[groupId] = { ...info, name, notice };\r\n  }\r\n\r\n  // обновляем активный чат\r\n  newState.activeRoom = getFreshActiveRoom(newState);\r\n\r\n  return newState;\r\n};\r\n\r\nconst updateUserInfo = (state: ChatState, user: User) => {\r\n  const newState = { ...state };\r\n\r\n  const { userId, username, avatar } = user;\r\n\r\n  if (newState.userGather[userId]) {\r\n    newState.userGather[userId] = {\r\n      ...newState.userGather[userId],\r\n      username,\r\n      avatar,\r\n    };\r\n  }\r\n\r\n  if (newState.contactGather[userId]) {\r\n    newState.contactGather[userId] = {\r\n      ...newState.contactGather[userId],\r\n      username,\r\n      avatar,\r\n    };\r\n  }\r\n\r\n  // обновляем активный чат\r\n  newState.activeRoom = getFreshActiveRoom(newState);\r\n\r\n  return newState;\r\n};\r\n\r\nconst addGroupMember = (state: ChatState, payload: GroupMember) => {\r\n  const members: Contact[] = payload.members.map((member) => ({\r\n    ...member,\r\n    isManager: 0,\r\n  }));\r\n\r\n  const newState = { ...state };\r\n\r\n  if (newState.groupGather[payload.groupId].members && members) {\r\n    newState.groupGather[payload.groupId].members = [\r\n      ...(state.groupGather[payload.groupId].members as Contact[]),\r\n      ...members,\r\n    ];\r\n  } else {\r\n    newState.groupGather[payload.groupId] = {\r\n      ...newState.groupGather[payload.groupId],\r\n      members,\r\n    };\r\n  }\r\n\r\n  // обновляем активный чат\r\n  newState.activeRoom = getFreshActiveRoom(newState);\r\n  return newState;\r\n};\r\n\r\nconst markPrivateMessagesRead = (state: ChatState, userId: number) => {\r\n  const newState = { ...state };\r\n\r\n  if (newState.contactGather[userId]) {\r\n    const updatedValue = { ...newState.contactGather[userId] };\r\n\r\n    if (updatedValue.messages) {\r\n      for (let i = 0; i < updatedValue.messages.length; i++)\r\n        updatedValue.messages[i] = {\r\n          ...updatedValue.messages[i],\r\n          status: 1,\r\n        };\r\n    }\r\n    newState.contactGather[userId] = updatedValue;\r\n  }\r\n\r\n  // обновляем активный чат\r\n  newState.activeRoom = getFreshActiveRoom(newState);\r\n\r\n  return newState;\r\n};\r\n\r\nconst addPrivateMessages = (state: ChatState, data: AddPrivateMessages) => {\r\n  const newState = { ...state };\r\n\r\n  const { messages, contactId } = data;\r\n\r\n  if (newState.contactGather[contactId]) {\r\n    newState.contactGather[contactId] = {\r\n      ...newState.contactGather[contactId],\r\n      messages: [\r\n        ...messages,\r\n        ...(newState.contactGather[contactId].messages || []),\r\n      ],\r\n      noMoreData: messages.length < data.pageSize,\r\n    };\r\n  }\r\n\r\n  // обновляем активный чат\r\n  newState.activeRoom = getFreshActiveRoom(newState);\r\n\r\n  return newState;\r\n};\r\n\r\nconst addGroupMessages = (state: ChatState, data: AddGroupMessages) => {\r\n  const newState = { ...state };\r\n\r\n  const { groupId, messageArr: messages, userArr: users } = data;\r\n\r\n  if (newState.groupGather[groupId]) {\r\n    newState.groupGather[groupId] = {\r\n      ...newState.groupGather[groupId],\r\n      messages: [\r\n        ...messages,\r\n        ...(newState.groupGather[groupId].messages || []),\r\n      ],\r\n      noMoreData: messages.length < data.pageSize,\r\n    };\r\n  }\r\n\r\n  newState.userGather = { ...newState.userGather };\r\n  for (const user of users) {\r\n    if (!newState.userGather[user.userId]) {\r\n      newState.userGather[user.userId] = user;\r\n    }\r\n  }\r\n\r\n  // обновляем активный чат\r\n  newState.activeRoom = getFreshActiveRoom(newState);\r\n\r\n  return newState;\r\n};\r\n\r\nconst setActiveRoom = (state: ChatState, data: SetActiveRoom) => {\r\n  if (state.activeRoom && data.ifNotExists) return state;\r\n  return {\r\n    ...state,\r\n    activeRoom: data.groupId\r\n      ? state.groupGather[data.groupId]\r\n      : data.contactId\r\n        ? state.contactGather[data.contactId]\r\n        : null,\r\n  };\r\n};\r\n\r\nconst setToken = (state: ChatState, token: string): ChatState => {\r\n  localStorage.setItem(state.tokenKey, token);\r\n  return {\r\n    ...state,\r\n    token,\r\n  };\r\n};\r\n\r\nconst clearUser = (state: ChatState): ChatState => {\r\n  localStorage.removeItem(state.tokenKey);\r\n  return {\r\n    ...state,\r\n    token: \"\",\r\n    user: emptyUser,\r\n  };\r\n};\r\n\r\nconst setConference = (\r\n  state: ChatState,\r\n  conference: ConferenceData\r\n): ChatState => {\r\n  return {\r\n    ...state,\r\n    conference: {\r\n      data: { ...conference },\r\n      joined: conference?.userId === state.user.userId,\r\n      ringPlayed: conference?.userId !== state.user.userId,\r\n    },\r\n  };\r\n};\r\n\r\nconst pauseConference = (\r\n  state: ChatState,\r\n  conference: ConferenceData\r\n): ChatState => {\r\n  if (state.conference.data?.id !== conference?.id) return state;\r\n  return {\r\n    ...state,\r\n    conference: {\r\n      data: { ...state.conference.data },\r\n      joined: false,\r\n      ringPlayed: false,\r\n    },\r\n  };\r\n};\r\n\r\nconst stopConference = (\r\n  state: ChatState,\r\n  conference: ConferenceData\r\n): ChatState => {\r\n  if (state.conference.data?.id !== conference?.id) return state;\r\n  return {\r\n    ...state,\r\n    conference: { data: null, joined: false, ringPlayed: false },\r\n  };\r\n};\r\n\r\nfunction chatReducer(state: ChatState, action: Action): ChatState {\r\n  switch (action.type) {\r\n    case \"SET_GROUP_GATHER\":\r\n      return {\r\n        ...state,\r\n        groupGather: {\r\n          ...state.groupGather,\r\n          [(action.payload as Group).groupId]: action.payload as Group,\r\n        },\r\n      };\r\n    case \"SET_CONTACT_GATHER\":\r\n      return {\r\n        ...state,\r\n        contactGather: {\r\n          ...state.contactGather,\r\n          [(action.payload as Contact).userId]: action.payload as Contact,\r\n        },\r\n      };\r\n    case \"DEL_GROUP\":\r\n      return delGroup(state, action.payload as number);\r\n    case \"DEL_GROUP_MEMBER\":\r\n      return delGroupMember(state, action.payload as GroupMap);\r\n    case \"DEL_CONTACT\":\r\n      return delContact(state, (action.payload as Contact).userId);\r\n    case \"SET_USER_GATHER\":\r\n      return {\r\n        ...state,\r\n        userGather: {\r\n          ...state.userGather,\r\n          [(action.payload as User).userId]: action.payload as User,\r\n        },\r\n      };\r\n    case \"UPDATE_ACTIVE_ROOM\":\r\n      return { ...state, activeRoom: getActiveRoom(state) };\r\n    case \"SET_ACTIVE_ROOM\":\r\n      return setActiveRoom(state, action.payload as SetActiveRoom);\r\n    case \"USER_ONLINE\":\r\n      return setUserOnline(state, action.payload as number, 1);\r\n    case \"USER_OFFLINE\":\r\n      return setUserOnline(state, action.payload as number, 0);\r\n    case \"ADD_GROUP_MESSAGE\":\r\n      return addGroupMessage(state, action.payload as GroupMessage);\r\n    case \"ADD_PRIVATE_MESSAGE\":\r\n      return addPrivateMessage(state, action.payload as PrivateMessage);\r\n    case \"ADD_GROUP_UNREAD_GATHER\":\r\n      return groupUnreadGather(\r\n        state,\r\n        action.payload as number,\r\n        (x?: number) => (x || 0) + 1\r\n      );\r\n    case \"ADD_CONTACT_UNREAD_GATHER\":\r\n      return contactUnreadGather(\r\n        state,\r\n        action.payload as number,\r\n        (x?: number) => (x || 0) + 1\r\n      );\r\n    case \"SET_TYPING\":\r\n      return { ...state, typing: action.payload as SetTyping };\r\n    case \"LOSE_GROUP_UNREAD_GATHER\":\r\n      return groupUnreadGather(state, action.payload as number, () => 0);\r\n    case \"LOSE_CONTACT_UNREAD_GATHER\":\r\n      return contactUnreadGather(state, action.payload as number, () => 0);\r\n    case \"REVOKE_MESSAGE\":\r\n      return revokeMessage(state, action.payload as MessageOperation);\r\n    case \"UPDATE_GROUP_INFO\":\r\n      return updateGroupInfo(state, action.payload as Group);\r\n    case \"UPDATE_USER_INFO\":\r\n      return updateUserInfo(state, action.payload as User);\r\n    case \"ADD_GROUP_MEMBER\":\r\n      return addGroupMember(state, action.payload as GroupMember);\r\n    case \"SET_CONFERENCE\":\r\n      return setConference(state, action.payload as ConferenceData);\r\n    case \"JOIN_CONFERENCE\":\r\n      return {\r\n        ...state,\r\n        conference: {\r\n          data: { ...action.payload as ConferenceData },\r\n          joined: true,\r\n          ringPlayed: false,\r\n        },\r\n      };\r\n    case \"PAUSE_CONFERENCE\":\r\n      return pauseConference(state, action.payload as ConferenceData);\r\n    case \"STOP_CONFERENCE\":\r\n      return stopConference(state, action.payload as ConferenceData);\r\n    case \"MARK_PRIVATE_MESSAGES_READ\":\r\n      return markPrivateMessagesRead(state, action.payload as number);\r\n    case \"ADD_PRIVATE_MESSAGES\":\r\n      return addPrivateMessages(state, action.payload as AddPrivateMessages);\r\n    case \"ADD_GROUP_MESSAGES\":\r\n      return addGroupMessages(state, action.payload as AddGroupMessages);\r\n    case \"SET_LOADING\":\r\n      return {\r\n        ...state,\r\n        loading: action.payload as boolean,\r\n        error: \"\",\r\n      };\r\n    case \"SET_ERROR\":\r\n      return {\r\n        ...state,\r\n        error: action.payload as string,\r\n      };\r\n    case \"SET_TOKEN\":\r\n      return setToken(state, action.payload as string);\r\n    case \"SET_USER\":\r\n      return {\r\n        ...state,\r\n        user: action.payload as User,\r\n      };\r\n    case \"CLEAR_USER\":\r\n      return clearUser(state);\r\n    case \"CLEAR_CHAT_DATA\":\r\n      return {\r\n        ...state,\r\n        activeRoom: null,\r\n        groupGather: {},\r\n        userGather: {},\r\n        contactGather: {},\r\n        conference: {\r\n          data: null,\r\n          joined: false,\r\n          ringPlayed: false,\r\n        },\r\n        typing: null,\r\n      };\r\n    case \"SET_OPERATORS\":\r\n      return {\r\n        ...state,\r\n        operators: action.payload as Contact[],\r\n      };\r\n  }\r\n\r\n  return state;\r\n}\r\n\r\nexport type ChatDispatch = React.Dispatch<Action>;\r\nconst emptyDispatch: ChatDispatch = () => null;\r\n\r\ntype ChatProviderProps = {\r\n  defLang: string | undefined;\r\n  tokenKey: string;\r\n  children: JSX.Element | JSX.Element[];\r\n};\r\n\r\nexport const ChatContext = React.createContext({\r\n  state: emptyChatState,\r\n  dispatch: emptyDispatch,\r\n});\r\n\r\nexport const ChatProvider: React.FC<ChatProviderProps> = (\r\n  props: ChatProviderProps\r\n) => {\r\n  emptyUser.langCode = props.defLang;\r\n  const token = localStorage.getItem(props.tokenKey) as string;\r\n  const chatState: ChatState = {\r\n    ...emptyChatState,\r\n    tokenKey: props.tokenKey,\r\n    token,\r\n  };\r\n\r\n  const [state, dispatch] = React.useReducer(chatReducer, chatState);\r\n\r\n  return (\r\n    <ChatContext.Provider value={{ state, dispatch }}>\r\n      {props.children}\r\n    </ChatContext.Provider>\r\n  );\r\n};\r\n","import React, { createContext, useCallback, useContext } from \"react\";\r\nimport { ChatContext } from \"./ChatContext\";\r\nimport axios, { AxiosError, AxiosInstance } from \"axios\";\r\nimport { Contact, Group, PagingResponse, PrivateMessage } from \"../types\";\r\n\r\nexport interface IRestContext {\r\n  apiUrl: string;\r\n  pageSize: number;\r\n  fetch: AxiosInstance | null;\r\n  getPrivateMessages: (chat: Contact) => Promise<void>;\r\n  getGroupMessages: (chat: Group) => Promise<void>;\r\n}\r\nconst initialContext = {} as IRestContext;\r\n\r\nexport const RestContext: React.Context<IRestContext> = createContext(\r\n  initialContext\r\n);\r\n\r\ntype RestProviderProps = {\r\n  baseURLApi: string;\r\n  pageSize: number;\r\n  children: JSX.Element;\r\n};\r\n\r\nexport const RestProvider: React.FC<RestProviderProps> = ({\r\n  baseURLApi,\r\n  pageSize,\r\n  children\r\n}: RestProviderProps) => {\r\n  const { state, dispatch } = useContext(ChatContext);\r\n\r\n  const fetch: AxiosInstance = axios.create({\r\n    timeout: 60000, // Таймаут минута\r\n    baseURL: baseURLApi,\r\n    headers: {\r\n      \"Cache-Control\": \"no-cache\",\r\n      Pragma: \"no-cache\",\r\n      Authorization: `Bearer ${state.token}`\r\n    },\r\n    withCredentials: false\r\n  });\r\n\r\n  const getPrivateMessages = useCallback(\r\n    async (chat: Contact) => {\r\n      const contactId = chat.userId;\r\n      const current = chat.messages?.length;\r\n      try {\r\n        dispatch({ type: \"SET_LOADING\", payload: true });\r\n        const { data } = await fetch.get(\"/contact/messages\", {\r\n          params: {\r\n            contactId,\r\n            current,\r\n            pageSize\r\n          }\r\n        });\r\n        if (data) {\r\n          dispatch({\r\n            type: \"ADD_PRIVATE_MESSAGES\",\r\n            payload: {\r\n              pageSize,\r\n              contactId,\r\n              messages: data as PrivateMessage[]\r\n            }\r\n          });\r\n        }\r\n      } catch (error) {\r\n        const err = error as AxiosError;\r\n        dispatch({ type: \"SET_ERROR\", payload: err.message });\r\n      } finally {\r\n        dispatch({ type: \"SET_LOADING\", payload: false });\r\n      }\r\n    },\r\n    [dispatch]\r\n  );\r\n\r\n  const getGroupMessages = useCallback(\r\n    async (chat: Group) => {\r\n      const { groupId } = chat;\r\n      const current = chat.messages?.length;\r\n      try {\r\n        dispatch({ type: \"SET_LOADING\", payload: true });\r\n        const { data }: { data: PagingResponse } = await fetch.get(\r\n          \"/group/messages\",\r\n          {\r\n            params: {\r\n              groupId,\r\n              current,\r\n              pageSize\r\n            }\r\n          }\r\n        );\r\n        if (data) {\r\n          dispatch({\r\n            type: \"ADD_GROUP_MESSAGES\",\r\n            payload: {\r\n              pageSize,\r\n              groupId,\r\n              ...data\r\n            }\r\n          });\r\n        }\r\n      } catch (error) {\r\n        const err = error as AxiosError;\r\n        dispatch({ type: \"SET_ERROR\", payload: err.message });\r\n      } finally {\r\n        dispatch({ type: \"SET_LOADING\", payload: false });\r\n      }\r\n    },\r\n    [dispatch]\r\n  );\r\n\r\n  return (\r\n    <RestContext.Provider\r\n      value={{\r\n        apiUrl: baseURLApi,\r\n        pageSize,\r\n        fetch,\r\n        getPrivateMessages,\r\n        getGroupMessages\r\n      }}\r\n    >\r\n      {children}\r\n    </RestContext.Provider>\r\n  );\r\n};\r\n","import { useCallback, useEffect, useState } from \"react\";\r\nimport io, { Socket } from \"socket.io-client\";\r\n\r\nexport const useSocket = (\r\n  url: string,\r\n  accessToken: string\r\n): {\r\n  socket: Socket | null;\r\n  online: boolean;\r\n  connectSocket: () => void;\r\n  disconnectSocket: () => void;\r\n} => {\r\n  const [socket, setSocket] = useState<Socket | null>(null);\r\n\r\n  const connectSocket = useCallback(() => {\r\n    // console.log(\"do connect\");\r\n    const socketTemp = io(url, {\r\n      reconnection: true,\r\n      extraHeaders: {\r\n        Authorization: `Bearer ${accessToken}`,\r\n      },\r\n    });\r\n    setSocket(socketTemp);\r\n  }, [url, accessToken]);\r\n\r\n  const disconnectSocket = useCallback(() => {\r\n    // console.log(\"do disconnect\");\r\n    socket?.disconnect();\r\n    setSocket(null);\r\n  }, [socket]);\r\n\r\n  const [online, setOnline] = useState<boolean>(false);\r\n\r\n  useEffect(() => {\r\n    setOnline(socket?.connected ? true : false);\r\n  }, [socket]);\r\n\r\n  useEffect(() => {\r\n    socket?.on(\"connect\", () => {\r\n      // console.log(\"connected\");\r\n      setOnline(true);\r\n      socket.emit(\"chatData\");\r\n    });\r\n  }, [socket]);\r\n\r\n  useEffect(() => {\r\n    socket?.on(\"disconnect\", () => {\r\n      // console.log(\"disconnected\");\r\n      setOnline(false);\r\n    });\r\n  }, [socket]);\r\n\r\n  return {\r\n    socket,\r\n    online,\r\n    disconnectSocket,\r\n    connectSocket,\r\n  };\r\n};\r\n","import React, { createContext, useContext, useEffect } from \"react\";\r\nimport { Socket } from \"socket.io-client\";\r\nimport { useSocket } from \"../hooks/useSocket\";\r\nimport {\r\n  ChatData,\r\n  Contact,\r\n  Group,\r\n  GroupMessage,\r\n  JoinGroup,\r\n  MessageOperation,\r\n  PrivateMessage,\r\n  SetTyping,\r\n  User,\r\n  ConferenceData,\r\n  SetActiveRoom,\r\n  GroupMap,\r\n} from \"../types\";\r\nimport { ChatContext } from \"./ChatContext\";\r\n\r\n// Формат ответа сервера\r\ninterface ServerRes {\r\n  code: number;\r\n  msg: string;\r\n  data: unknown;\r\n}\r\n\r\nexport interface ISocketContext {\r\n  socket: Socket | null;\r\n  online: boolean;\r\n}\r\nconst initialContext = {\r\n  online: false,\r\n} as ISocketContext;\r\n\r\nexport const SocketContext: React.Context<ISocketContext> =\r\n  createContext(initialContext);\r\n\r\ntype SocketProviderProps = {\r\n  wsUrl: string;\r\n  children: JSX.Element;\r\n};\r\n\r\nexport const SocketProvider: React.FC<SocketProviderProps> = ({\r\n  wsUrl,\r\n  children,\r\n}: SocketProviderProps) => {\r\n  const { state, dispatch } = useContext(ChatContext);\r\n  const { socket, online, disconnectSocket, connectSocket } = useSocket(\r\n    wsUrl,\r\n    state.token\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (state.token) {\r\n      connectSocket();\r\n    }\r\n    return () => {\r\n      disconnectSocket();\r\n    };\r\n  }, [state.token, connectSocket]);\r\n\r\n  useEffect(() => {\r\n    if (!state.token) disconnectSocket();\r\n  }, [state.token, disconnectSocket]);\r\n\r\n  // listen unauthorized event\r\n  useEffect(() => {\r\n    const listener = (msg: string) => {\r\n      console.log(\"unauthorized msg\", msg);\r\n      dispatch({ type: \"CLEAR_USER\" });\r\n    };\r\n\r\n    // attach\r\n    socket?.on(\"unauthorized\", listener);\r\n    // detatch\r\n    return () => {\r\n      socket?.off(\"unauthorized\", listener);\r\n    };\r\n  }, [socket?.id]);\r\n\r\n  // listen chatData event\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      const payload = res.data as ChatData;\r\n      const groupArr = payload.groupData;\r\n      const contactArr = payload.contactData;\r\n      const userArr = payload.userData;\r\n      dispatch({ type: \"CLEAR_CHAT_DATA\" });\r\n      dispatch({ type: \"SET_USER\", payload: payload.user });\r\n      if (groupArr.length) {\r\n        for (const group of groupArr) {\r\n          socket?.emit(\"joinGroupSocket\", {\r\n            groupId: group.groupId,\r\n          });\r\n          dispatch({ type: \"SET_GROUP_GATHER\", payload: group });\r\n        }\r\n      }\r\n      if (contactArr.length) {\r\n        for (const contact of contactArr) {\r\n          socket?.emit(\"joinPrivateSocket\", {\r\n            contactId: contact.userId,\r\n          });\r\n          dispatch({ type: \"SET_CONTACT_GATHER\", payload: contact });\r\n        }\r\n      }\r\n      dispatch({ type: \"SET_OPERATORS\", payload: payload.operatorData });\r\n      if (userArr.length) {\r\n        for (const user_ of userArr) {\r\n          dispatch({ type: \"SET_USER_GATHER\", payload: user_ });\r\n        }\r\n      }\r\n      dispatch({ type: \"UPDATE_ACTIVE_ROOM\" });\r\n      dispatch({type: \"SET_CONFERENCE\", payload: payload.conferenceData})\r\n    };\r\n    socket?.on(\"chatData\", listener);\r\n    return () => {\r\n      socket?.off(\"chatData\", listener);\r\n    };\r\n  }, [socket?.id]);\r\n\r\n  // listen user online\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      dispatch({ type: \"USER_ONLINE\", payload: res.data as number });\r\n    };\r\n    socket?.on(\"userOnline\", listener);\r\n    return () => {\r\n      socket?.off(\"userOnline\", listener);\r\n    };\r\n  }, [socket?.id]);\r\n\r\n  // listen user offline\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      dispatch({ type: \"USER_OFFLINE\", payload: res.data as number });\r\n    };\r\n    socket?.on(\"userOffline\", listener);\r\n    return () => {\r\n      socket?.off(\"userOffline\", listener);\r\n    };\r\n  }, [socket?.id]);\r\n\r\n  // listen private socket join\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      console.log(\"Успешно вошел в приватный чат\");\r\n    };\r\n    socket?.on(\"joinPrivateSocket\", listener);\r\n    return () => {\r\n      socket?.off(\"joinPrivateSocket\", listener);\r\n    };\r\n  }, [socket?.id]);\r\n\r\n  // listen group socket join\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      const data = res.data as JoinGroup;\r\n      const newUser: Contact = data.user;\r\n      newUser.online = 1;\r\n      const { group } = data;\r\n      const groupObj = state.groupGather[group.groupId];\r\n      // Информация о присоединении к группе новых пользователей\r\n      if (\r\n        groupObj &&\r\n        !groupObj.members?.find((member) => member.userId === newUser.userId)\r\n      ) {\r\n        newUser.isManager = 0;\r\n        groupObj.members?.push(newUser);\r\n        // Vue.prototype.$message.info(res.msg);\r\n      }\r\n      dispatch({ type: \"SET_USER_GATHER\", payload: newUser });\r\n    };\r\n    socket?.on(\"joinGroupSocket\", listener);\r\n    return () => {\r\n      socket?.off(\"joinGroupSocket\", listener);\r\n    };\r\n  }, [socket?.id, state.groupGather]);\r\n\r\n  useEffect(() => {\r\n    const listener = async (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      const data = res.data as GroupMessage;\r\n      dispatch({ type: \"ADD_GROUP_MESSAGE\", payload: data });\r\n      const { activeRoom } = state;\r\n      if (\r\n        activeRoom &&\r\n        (activeRoom as Group).groupId === data.groupId &&\r\n        data.userId !== state.user.userId\r\n      ) {\r\n        socket?.emit(\"markAsRead\", {\r\n          groupId: data.groupId,\r\n          _id: data._id,\r\n        });\r\n      }\r\n    };\r\n\r\n    socket?.on(\"groupMessage\", listener);\r\n    return () => {\r\n      socket?.off(\"groupMessage\", listener);\r\n    };\r\n  }, [socket?.id, state.activeRoom]);\r\n\r\n  useEffect(() => {\r\n    const listener = async (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      const data = res.data as PrivateMessage;\r\n      if (\r\n        data.contactId === state.user.userId ||\r\n        data.userId === state.user.userId\r\n      ) {\r\n        dispatch({\r\n          type: \"ADD_PRIVATE_MESSAGE\",\r\n          payload: data,\r\n        });\r\n\r\n        // если есть активная комната и это приватная комната (!groupId && userId) с отправителем сообщения (userId)\r\n        if (\r\n          state.activeRoom &&\r\n          !(state.activeRoom as Group).groupId &&\r\n          state.activeRoom?.userId === data.userId\r\n        ) {\r\n          socket?.emit(\"markAsRead\", {\r\n            contactId: data.userId,\r\n            _id: data._id,\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n    socket?.on(\"privateMessage\", listener);\r\n    return () => {\r\n      socket?.off(\"privateMessage\", listener);\r\n    };\r\n  }, [socket?.id, state.activeRoom]);\r\n\r\n  useEffect(() => {\r\n    let timer: NodeJS.Timeout;\r\n\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      if (timer) clearTimeout(timer);\r\n      dispatch({ type: \"SET_TYPING\", payload: res.data as SetTyping });\r\n      timer = setTimeout(() => {\r\n        dispatch({ type: \"SET_TYPING\", payload: null });\r\n      }, 1000);\r\n    };\r\n    socket?.on(\"typing\", listener);\r\n    return () => {\r\n      if (timer) clearTimeout(timer);\r\n      socket?.off(\"typing\", listener);\r\n    };\r\n  }, [socket?.id]);\r\n\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      const data = res.data as MessageOperation;\r\n      if (data.userId === state.user.userId) {\r\n        if (data.groupId) {\r\n          dispatch({\r\n            type: \"LOSE_GROUP_UNREAD_GATHER\",\r\n            payload: data.groupId,\r\n          });\r\n        } else {\r\n          dispatch({\r\n            type: \"LOSE_CONTACT_UNREAD_GATHER\",\r\n            payload: data.contactId,\r\n          });\r\n        }\r\n      } else {\r\n        if (data.contactId)\r\n          dispatch({\r\n            type: \"MARK_PRIVATE_MESSAGES_READ\",\r\n            payload: data.userId,\r\n          });\r\n      }\r\n    };\r\n    socket?.on(\"markAsRead\", listener);\r\n    return () => {\r\n      socket?.off(\"markAsRead\", listener);\r\n    };\r\n  }, [socket?.id, state.user.userId]);\r\n\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      const data = res.data as MessageOperation;\r\n      dispatch({ type: \"REVOKE_MESSAGE\", payload: data });\r\n    };\r\n    socket?.on(\"revokeMessage\", listener);\r\n    return () => {\r\n      socket?.off(\"revokeMessage\", listener);\r\n    };\r\n  }, [socket?.id]);\r\n\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      dispatch({ type: \"SET_GROUP_GATHER\", payload: res.data as Group });\r\n    };\r\n    socket?.on(\"addGroup\", listener);\r\n    return () => {\r\n      socket?.off(\"addGroup\", listener);\r\n    };\r\n  }, [socket?.id]);\r\n\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      const data = res.data as Contact;\r\n      dispatch({ type: \"SET_CONTACT_GATHER\", payload: data });\r\n      dispatch({ type: \"SET_USER_GATHER\", payload: data });\r\n      socket?.emit(\"joinPrivateSocket\", {\r\n        contactId: data.userId,\r\n      });\r\n    };\r\n    socket?.on(\"addContact\", listener);\r\n    return () => {\r\n      socket?.off(\"addContact\", listener);\r\n    };\r\n  }, [socket?.id]);\r\n\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      const data = res.data as GroupMap;\r\n      if (data.userId === state.user.userId) {\r\n        // если удаляем себя из группы\r\n        dispatch({ type: \"DEL_GROUP\", payload: data.groupId });\r\n      } else {\r\n        dispatch({ type: \"DEL_GROUP_MEMBER\", payload: data });\r\n      }\r\n    };\r\n    socket?.on(\"deleteGroup\", listener);\r\n    return () => {\r\n      socket?.off(\"deleteGroup\", listener);\r\n    };\r\n  }, [socket?.id, state.user]);\r\n\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      const data = res.data as Contact;\r\n      dispatch({ type: \"DEL_CONTACT\", payload: data });\r\n    };\r\n    socket?.on(\"deleteContact\", listener);\r\n    return () => {\r\n      socket?.off(\"deleteContact\", listener);\r\n    };\r\n  }, [socket?.id]);\r\n\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      const data = res.data as Group;\r\n      dispatch({ type: \"UPDATE_GROUP_INFO\", payload: data });\r\n    };\r\n    socket?.on(\"updateGroupInfo\", listener);\r\n    return () => {\r\n      socket?.off(\"updateGroupInfo\", listener);\r\n    };\r\n  }, [socket?.id]);\r\n\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      const data = res.data as User;\r\n      dispatch({ type: \"UPDATE_USER_INFO\", payload: data });\r\n    };\r\n    socket?.on(\"updateUserInfo\", listener);\r\n    return () => {\r\n      socket?.off(\"updateUserInfo\", listener);\r\n    };\r\n  }, [socket?.id]);\r\n\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      const { group, user: newUser } = res.data as JoinGroup;\r\n\r\n      if (!state.groupGather[group.groupId]) {\r\n        console.log(\"joined to a new group\");\r\n        // Если группы еще у нас нет, то получаем информацию о пользователях в группе\r\n        socket?.emit(\"chatData\");\r\n      } else if (newUser.userId !== state.user.userId) {\r\n        // Новые пользователи присоединяются к группе\r\n        dispatch({\r\n          type: \"ADD_GROUP_MEMBER\",\r\n          payload: {\r\n            groupId: group.groupId,\r\n            members: [newUser],\r\n          },\r\n        });\r\n      }\r\n    };\r\n    socket?.on(\"joinGroup\", listener);\r\n    return () => {\r\n      socket?.off(\"joinGroup\", listener);\r\n    };\r\n  }, [socket?.id, state.user, state.groupGather]);\r\n\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      dispatch({ type: \"SET_CONFERENCE\", payload: res.data as ConferenceData });\r\n    };\r\n    socket?.on(\"startConference\", listener);\r\n    return () => {\r\n      socket?.off(\"startConference\", listener);\r\n    };\r\n  }, [socket?.id]);\r\n\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      dispatch({\r\n        type: \"PAUSE_CONFERENCE\",\r\n        payload: res.data as ConferenceData,\r\n      });\r\n    };\r\n    socket?.on(\"pauseConference\", listener);\r\n    return () => {\r\n      socket?.off(\"pauseConference\", listener);\r\n    };\r\n  }, [socket?.id]);\r\n\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      dispatch({\r\n        type: \"STOP_CONFERENCE\",\r\n        payload: res.data as ConferenceData,\r\n      });\r\n    };\r\n    socket?.on(\"stopConference\", listener);\r\n    return () => {\r\n      socket?.off(\"stopConference\", listener);\r\n    };\r\n  }, [socket?.id]);\r\n\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n    };\r\n    socket?.on(\"addOperator\", listener);\r\n    return () => {\r\n      socket?.off(\"addOperator\", listener);\r\n    };\r\n  }, [socket?.id]);\r\n\r\n  useEffect(() => {\r\n    const listener = (res: ServerRes) => {\r\n      if (res.code) {\r\n        dispatch({ type: \"SET_ERROR\", payload: res.msg });\r\n        return;\r\n      }\r\n      dispatch({\r\n        type: \"SET_ACTIVE_ROOM\",\r\n        payload: res.data as SetActiveRoom,\r\n      });\r\n    };\r\n    socket?.on(\"setActiveRoom\", listener);\r\n    return () => {\r\n      socket?.off(\"setActiveRoom\", listener);\r\n    };\r\n  }, [socket?.id]);\r\n\r\n  return (\r\n    <SocketContext.Provider value={{ socket, online }}>\r\n      {children}\r\n    </SocketContext.Provider>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport {\r\n  Container,\r\n  Box,\r\n  Grid,\r\n\r\n  Snackbar,\r\n  useMediaQuery,\r\n} from \"@mui/material\";\r\nimport { makeStyles } from '@mui/styles';\r\nimport { Theme } from '@mui/material/styles';\r\nimport { Alert } from \"@mui/lab\";\r\nimport { Room, RoomList, Conference } from \"../components\";\r\nimport { ChatContext } from \"../context/ChatContext\";\r\nimport { RestContext } from \"../context/RestContext\";\r\nimport { SocketContext } from \"../context/SocketContext\";\r\nimport {\r\n  ChatPa,\r\n  Group,\r\n  Contact,\r\n  ChatMessage,\r\n  ChatRoom,\r\n  SendMessage,\r\n  ConferenceData,\r\n} from \"../types\";\r\nimport { isEmpty } from \"../utils/common\";\r\nimport ConferenceCall from \"../components/ConferenceCall\";\r\n\r\nconst getRingAudio = (): HTMLAudioElement => {\r\n  const audio = new Audio(process.env.PUBLIC_URL + \"/audio/ring-in.ogg\");\r\n  audio.loop = true;\r\n  return audio;\r\n};\r\n\r\nexport const ChatPage: React.FC<ChatPa> = ({\r\n  inModale,\r\n  onlyChatGroupId,\r\n}: ChatPa) => {\r\n  const useStyles = makeStyles((theme: Theme) => ({\r\n    root: {\r\n      minWidth: 640,\r\n      minHeight: 470,\r\n      height: inModale ? \"100%\" : `calc(100vh - ${theme.spacing(8)})`,\r\n      padding: 0,\r\n      [theme.breakpoints.down(\"sm\")]: {\r\n        height: `calc(100vh - ${theme.spacing(8)})`,\r\n        minWidth: 'auto',\r\n        minHeight: 'auto',\r\n        overflow: \"hidden\"\r\n      },\r\n    },\r\n    innerBox: {\r\n      height: \"100%\",\r\n      width: \"100%\",\r\n      margin: inModale ? 0 : `${theme.spacing(4)} 0`,\r\n      [theme.breakpoints.down(\"sm\")]: {\r\n        margin: 0,\r\n      },\r\n    },\r\n    innerGrid: {\r\n      height: \"100%\",\r\n      width: \"100%\",\r\n    },\r\n  }));\r\n  const classes = useStyles();\r\n  const isMobile = useMediaQuery((theme: Theme) =>\r\n    theme.breakpoints.down(\"sm\")\r\n  );\r\n\r\n  const { state, dispatch } = React.useContext(ChatContext);\r\n  const { socket } = React.useContext(SocketContext);\r\n\r\n  const { apiUrl, pageSize, getPrivateMessages, getGroupMessages } =\r\n    React.useContext(RestContext);\r\n\r\n  const [ringAudio] = React.useState(getRingAudio());\r\n\r\n  const onExitActiveRoom = React.useCallback(() => {\r\n    dispatch({\r\n      type: \"SET_ACTIVE_ROOM\",\r\n      payload: { ifNotExists: false },\r\n    });\r\n  }, [dispatch]);\r\n\r\n  const onNeedMoreMessages = React.useCallback(\r\n    async (chat: ChatRoom) => {\r\n      if ((chat as Group).groupId) await getGroupMessages(chat as Group);\r\n      else await getPrivateMessages(chat as Contact);\r\n    },\r\n    [getPrivateMessages, getGroupMessages]\r\n  );\r\n\r\n  const onMessageDelete = React.useCallback(\r\n    (chat: ChatRoom, message: ChatMessage) => {\r\n      socket?.emit(\"revokeMessage\", {\r\n        groupId: (chat as Group).groupId, // Идентификатор группы\r\n        contactId: chat.userId, // Идентификатор контакта\r\n        _id: message._id, // Идентификатор удаленного сообщения\r\n      });\r\n    },\r\n    [socket?.id]\r\n  );\r\n\r\n  const onTyping = React.useCallback(\r\n    (chat: ChatRoom) => {\r\n      socket?.emit(\"typing\", {\r\n        groupId: (chat as Group)?.groupId,\r\n        contactId: chat?.userId,\r\n      });\r\n    },\r\n    [socket?.id]\r\n  );\r\n\r\n  const onSendMessage = React.useCallback(\r\n    (chat: ChatRoom, data: SendMessage) => {\r\n      if ((chat as Group).groupId) {\r\n        socket?.emit(\"groupMessage\", {\r\n          groupId: (chat as Group)?.groupId,\r\n          content: data.message,\r\n          width: data.width,\r\n          height: data.height,\r\n          fileName: data.fileName,\r\n          messageType: data.messageType,\r\n          size: data.size,\r\n        });\r\n      } else {\r\n        socket?.emit(\"privateMessage\", {\r\n          contactId: chat?.userId,\r\n          content: data.message,\r\n          width: data.width,\r\n          height: data.height,\r\n          fileName: data.fileName,\r\n          messageType: data.messageType,\r\n          size: data.size,\r\n        });\r\n      }\r\n    },\r\n    [socket?.id]\r\n  );\r\n\r\n  const onChangeChat = React.useCallback(\r\n    (chat: ChatRoom) => {\r\n      dispatch({\r\n        type: \"SET_ACTIVE_ROOM\",\r\n        payload: {\r\n          groupId: (chat as Group)?.groupId,\r\n          contactId: chat?.userId,\r\n          ifNotExists: false,\r\n        },\r\n      });\r\n    },\r\n    [socket?.id, dispatch]\r\n  );\r\n\r\n  const onEnterRoom = React.useCallback(\r\n    (chat: ChatRoom) => {\r\n      if (!chat.messages || chat.messages.length === 0) return;\r\n      if ((chat as Group).groupId) {\r\n        socket?.emit(\"markAsRead\", {\r\n          groupId: (chat as Group).groupId,\r\n          _id: chat.messages[chat.messages.length - 1]._id,\r\n        });\r\n      } else {\r\n        socket?.emit(\"markAsRead\", {\r\n          contactId: chat.userId,\r\n          _id: chat.messages[chat.messages.length - 1]._id,\r\n        });\r\n      }\r\n    },\r\n    [socket?.id]\r\n  );\r\n\r\n  const onVideoCall = React.useCallback(\r\n    (chat: ChatRoom) => {\r\n      socket?.emit(\"startConference\", {\r\n        groupId: (chat as Group).groupId,\r\n        contactId: chat.userId,\r\n      });\r\n    },\r\n    [socket?.id]\r\n  );\r\n\r\n  const onVideoEnd = React.useCallback(\r\n    (conference: ConferenceData | null) => {\r\n      if (conference?.id != null)\r\n        socket?.emit(\"stopConference\", {\r\n          id: conference?.id,\r\n        });\r\n    },\r\n    [socket?.id]\r\n  );\r\n\r\n  const onConferencePause = React.useCallback(\r\n    (conference: ConferenceData | null) => {\r\n      if (conference?.id != null)\r\n        socket?.emit(\"pauseConference\", {\r\n          id: conference.id,\r\n        });\r\n    },\r\n    [socket?.id]\r\n  );\r\n\r\n  const onConferenceCallAccept = React.useCallback(\r\n    (conference: ConferenceData) => {\r\n      dispatch({ type: \"JOIN_CONFERENCE\", payload: conference });\r\n    },\r\n    [dispatch]\r\n  );\r\n\r\n  const onOperatorAdd = React.useCallback(\r\n    (group: Group, operator: Contact) => {\r\n      socket?.emit(\"addOperator\", {\r\n        groupId: group.groupId,\r\n        operatorId: operator.userId,\r\n      });\r\n    },\r\n    [socket?.id]\r\n  );\r\n\r\n  const onLeaveGroup = React.useCallback(\r\n    (group: Group) => {\r\n      socket?.emit(\"deleteGroup\", {\r\n        groupId: group.groupId,\r\n      });\r\n    },\r\n    [socket?.id]\r\n  );\r\n\r\n  const handleError = React.useCallback(() => {\r\n    dispatch({ type: \"SET_ERROR\" });\r\n  }, [dispatch]);\r\n\r\n  React.useEffect(() => {\r\n    if (onlyChatGroupId != null) {\r\n      const onlyChat = Object.values(state.contactGather).find(\r\n        (item) => item.groupId === onlyChatGroupId\r\n      );\r\n\r\n      if (!isEmpty(onlyChat)) {\r\n        onChangeChat(onlyChat);\r\n      }\r\n    }\r\n  }, [state.contactGather]);\r\n\r\n  React.useEffect(() => {\r\n    if (state.conference.data?.id && state.conference.ringPlayed && !state.conference.joined)\r\n      ringAudio.play();\r\n    else ringAudio.pause();\r\n  }, [state.conference.data?.id, state.conference.ringPlayed]);\r\n\r\n  //  console.log(\"state.conference\", state.conference)\r\n\r\n  const renderRoom = state.activeRoom != null && (\r\n    <Room\r\n      apiUrl={apiUrl}\r\n      user={state.user}\r\n      users={state.userGather}\r\n      operators={state.operators}\r\n      chat={state.activeRoom}\r\n      typing={state.typing}\r\n      conference={state.conference.data}\r\n      loading={state.loading}\r\n      pageSize={pageSize}\r\n      onExitRoom={\r\n        isMobile && onlyChatGroupId == null ? onExitActiveRoom : undefined\r\n      }\r\n      onEnterRoom={onEnterRoom}\r\n      onNeedMoreMessages={onNeedMoreMessages}\r\n      onMeesageDelete={onMessageDelete}\r\n      onTyping={onTyping}\r\n      onSendMessage={onSendMessage}\r\n      onVideoCall={onVideoCall}\r\n      onVideoEnd={onVideoEnd}\r\n      onConferencePause={onConferencePause}\r\n      onOperatorAdd={onOperatorAdd}\r\n      onLeaveGroup={onLeaveGroup}\r\n    />\r\n  );\r\n\r\n  const GetRoomList = () => (\r\n    <RoomList\r\n      apiUrl={apiUrl}\r\n      user={state.user}\r\n      activeRoom={state.activeRoom}\r\n      groups={Object.values(state.groupGather)}\r\n      contacts={Object.values(state.contactGather)}\r\n      typing={state.typing}\r\n      onChangeChat={onChangeChat}\r\n    />\r\n  );\r\n\r\n  const GetConferenceCall = () =>\r\n    state.conference.data && (\r\n      <ConferenceCall\r\n        apiUrl={apiUrl}\r\n        contact={\r\n          state.contactGather[\r\n          state.user.userId === state.conference.data.userId\r\n            ? state.conference.data.contactId\r\n            : state.conference.data.userId\r\n          ]\r\n        }\r\n        conference={state.conference.data}\r\n        onAccept={onConferenceCallAccept}\r\n      />\r\n    );\r\n\r\n  const GetConference = () => (\r\n    <Conference\r\n      conference={state.conference.data}\r\n      onClose={onConferencePause}\r\n    />\r\n  );\r\n\r\n  const Contacts = React.useMemo(\r\n    () =>\r\n      state.conference.data?.id ? (\r\n        state.conference.joined ? (\r\n          <GetConference />\r\n        ) : (\r\n          <GetConferenceCall />\r\n        )\r\n      ) : (\r\n        <GetRoomList />\r\n      ),\r\n    [\r\n      state.conference.joined,\r\n      state.conference.data?.id,\r\n      state.activeRoom?.groupId,\r\n      state.activeRoom?.userId,\r\n      //state.activeRoom?.messages?.length,\r\n      state.activeRoom?.unreadCount,\r\n    ]\r\n  );\r\n  const isLeftPart = onlyChatGroupId == null || !!state.conference.data?.id;\r\n\r\n  //console.log(\"state.conference\", state.conference)\r\n  return (\r\n    <Container maxWidth=\"lg\" className={classes.root}>\r\n      <Box className={classes.innerBox}>\r\n        {isMobile ? (\r\n          <>\r\n            {isLeftPart && Contacts}\r\n            {renderRoom}\r\n          </>\r\n        ) : (\r\n          <Grid container spacing={1} className={classes.innerGrid}>\r\n            {isLeftPart && (\r\n              <Grid item sm={4} className={classes.innerGrid}>\r\n                {Contacts}\r\n              </Grid>\r\n            )}\r\n            <Grid item sm={isLeftPart ? 8 : 12} className={classes.innerGrid}>\r\n              {renderRoom}\r\n            </Grid>\r\n          </Grid>\r\n        )}\r\n      </Box>\r\n      <Snackbar\r\n        anchorOrigin={{ vertical: \"top\", horizontal: \"center\" }}\r\n        open={!!state.error}\r\n        autoHideDuration={6000}\r\n        onClose={handleError}\r\n      >\r\n        <Alert onClose={handleError} severity=\"error\">\r\n          {state.error}\r\n        </Alert>\r\n      </Snackbar>\r\n    </Container>\r\n  );\r\n};\r\n","import en from \"./en.json\";\r\nimport fr from \"./fr.json\";\r\nimport ru from \"./ru.json\";\r\n\r\nexport const chatResources = {\r\n  ru,\r\n  en,\r\n  fr,\r\n};\r\n"],"names":["MessageStatus","Role","ContextMenuType","useStyles","makeStyles","createStyles","item","cursor","Emoji","props","classes","emojiClick","e","onSelect","target","innerText","Item","itemProps","React.createElement","Box","emoji","theme","typingText","paddingLeft","spacing","typingDot","display","verticalAlign","width","height","margin","background","palette","primary","main","borderRadius","opacity","animation","animationDelay","Typing","React","Typography","message","undefined","input","flex","inputUpload","attachmentIcon","fill","stroke","getImageSize","data","Entry","chat","useTranslation","t","useState","empjiEl","setEmojiEl","text","setText","time","lastTyping","setLastTyping","handleEmojiClick","event","currentTarget","handleEmojiClose","emojiSelect","onChange","value","onTyping","Date","now","sendMessage","onSendMessage","submit","trim","length","messageType","onSubmitClick","preventDefault","onKeyPress","key","onSubmitFile","files","file","type","includes","image","Image","url","window","URL","webkitURL","src","createObjectURL","onload","imageSize","fileName","name","size","emojiOpen","Boolean","enojiId","TextField","disableUnderline","startAdornment","InputAdornment","IconButton","SvgIcon","InsertEmoticon","endAdornment","Send","Popover","vertical","horizontal","isEmpty","Object","keys","formatTime","moment","add","startOf","isAfter","format","getFileMeta","content","meta","split","date","userId","getImageMeta","splitFileName","idx","lastIndexOf","ext","slice","getChatId","groupId","getChatName","username","chatRoomComparer","a","b","hasMessagesA","Array","isArray","messages","hasMessagesB","cdate","getTime","fileIcon","fontSize","fileBody","File","Avatar","toUpperCase","mediaContent","maxWidth","maxHeight","Video","apiUrl","isConference","JSON","parse","visitId","breakpoints","down","viewerVisible","setViewerVisible","MessageContent","rootContact","color","backgroundColor","borderBottomLeftRadius","rootUser","justifyContent","contrastText","borderBottomRightRadius","rootNotify","padding","fontWeight","lastMessage","flexDirection","flexWrap","header","overflow","body","wordBreak","status","alignSelf","statusImage","marginRight","wrapMessage","isUserLast","onContextMenu","child","className","Link","isMedia","Message","owner","refOnLastMess","user","isGroupMessage","isUserFirst","ListItem","Alert","severity","isRevoke","revokeUserName","isMine","React.Fragment","Done","DoneAll","ContactStatus","isTyping","contact","online","star","ContactList","contacts","List","map","onClick","ListItemAvatar","avatar","ListItemText","AddContact","onClose","open","handleClose","handleListItemClick","Dialog","DialogTitle","popover","pointerEvents","paper","avatarGroup","getGroupStatus","group","members","onlineCount","reduce","sum","push","join","RoomHeader","typing","conference","operators","onVideoCall","onVideoEnd","onConferencePause","onOperatorAdd","onLeaveGroup","anchorEl","setAnchorEl","addOperatorOpen","setAddOperatorOpen","CardHeader","handlePopoverOpen","handlePopoverClose","handleAddOperatorOpen","handleAddOperatorClose","operator","role","find","it","contactId","console","log","Button","marginLeft","root","minWidth","inline","messageListOuter","overflowY","scrollbarWidth","scrollbarColor","border","messageList","roomHeader","roomProgress","flexAll","flexEnd","initialMenuState","mouseX","mouseY","canCopy","canDelete","initialScrollState","autoScroll","Room","users","loading","pageSize","scrollState","setScrollState","messageCount","useRef","refList","menuState","setMenuState","useEffect","onEnterRoom","useLayoutEffect","current","scrollIntoView","scrollTop","scrollHeight","onScroll","useCallback","noMoreData","onNeedMoreMessages","handleMenuPopup","onMeesageDelete","clientX","clientY","handleMenuClose","handleCopy","navigator","clipboard","writeText","handleDelete","Card","onExitRoom","CircularProgress","Divider","CardContent","inx","_id","Menu","top","left","MenuItem","ListItemIcon","whiteSpace","textOverflow","unread","getMessageText","TypingBadge","withStyles","badge","boxShadow","position","transform","Badge","OnlineBadge","contactAvatar","RoomListItem","roomName","roomText","roomTime","active","component","unreadCount","Chip","searchField","filterChats","chats","filter","lowerFilter","toLowerCase","indexOf","sortChats","groups","roomArr","sort","topChatId","localStorage","getItem","c","k","isTop","unshift","RoomList","setChats","onSearchChange","activeRoom","onChangeChat","Conference","ref","listener","source","contentWindow","addEventListener","removeEventListener","id","alignItems","pulse","footer","paddingTop","ConferenceCall","onAccept","Paper","emptyUser","password","langCode","emptyChatState","tokenKey","token","groupGather","userGather","contactGather","initialContactId","joined","ringPlayed","error","getFreshActiveRoom","state","getActiveRoom","newActiveRoom","rooms","values","setUserOnline","newState","member","m","index","findIndex","addGroupMessage","payload","groupUnreadGather","x","addPrivateMessage","contactUnreadGather","predicate","revokeMessage","userName","msg","delContact","updateActiveRoom","delGroup","delGroupMember","updateGroupInfo","notice","info","updateUserInfo","addGroupMember","isManager","markPrivateMessagesRead","updatedValue","i","addPrivateMessages","addGroupMessages","messageArr","userArr","setActiveRoom","ifNotExists","setToken","setItem","clearUser","removeItem","setConference","pauseConference","stopConference","chatReducer","action","emptyDispatch","ChatContext","createContext","dispatch","ChatProvider","defLang","chatState","useReducer","children","initialContext","RestContext","RestProvider","baseURLApi","useContext","fetch","axios","create","timeout","baseURL","headers","Pragma","Authorization","withCredentials","getPrivateMessages","get","params","err","getGroupMessages","useSocket","accessToken","socket","setSocket","connectSocket","socketTemp","io","reconnection","extraHeaders","disconnectSocket","disconnect","setOnline","connected","on","emit","SocketContext","SocketProvider","wsUrl","off","res","code","groupArr","groupData","contactArr","contactData","userData","operatorData","user_","conferenceData","newUser","groupObj","timer","clearTimeout","setTimeout","getRingAudio","audio","Audio","process","env","PUBLIC_URL","loop","ChatPage","inModale","onlyChatGroupId","minHeight","innerBox","innerGrid","isMobile","useMediaQuery","ringAudio","onExitActiveRoom","onMessageDelete","onConferenceCallAccept","operatorId","handleError","onlyChat","play","pause","renderRoom","GetRoomList","GetConferenceCall","GetConference","Contacts","isLeftPart","Container","Grid","Snackbar","chatResources","ru","en","fr"],"mappings":"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"}