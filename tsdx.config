const copy = require('rollup-plugin-copy');
const bundleSize = require('rollup-plugin-bundle-size');

module.exports = {
  rollup(config) {
    // Ensure i18next and react-i18next stay external
    config.external = [
      ...(config.external || []),
      'i18next',
      'react-i18next',
    ];

    // Bundle size reporting
    config.plugins.push(bundleSize());

    // Copy TypeScript declaration to dist
    config.plugins.push(
      copy({ targets: [{ src: 'src/index.d.ts', dest: 'dist' }] })
    );

    return config;
  },
};
